commit 48d10aafbaa519129838c3bf9f48be0a46fd9858
Author: Nightwalker743 <Hillardjoseph43@gmail.com>
Date:   Fri Feb 27 22:24:50 2026 -0600

    Control editor improvements, touchpad gestures, and new default presets (#599)
    
    * feat: Control editor improvements, touchpad gestures, and new default presets
    
    - Compose-based element editor dialog with full property editing (scale, shape, type, bindings, range button settings, shooter mode settings, dynamic joystick settings)
    - Touchpad gesture configuration (tap-to-click, two-finger scrolling, three-finger middle-click, sensitivity)
    - TouchGestureConfig data model with per-container persistence
    - Shooter mode enhancements (WASD, arrow keys, gamepad left stick movement types, configurable look sensitivity and joystick size)
    - Dynamic joystick element type with mouse look mode
    - Range button improvements (orientation, scroll lock, visible segments, multiple key ranges)
    - Two new default control presets: FPS and Hybrid Gamepad
    - Fix Copy From to properly transfer range button, shooter mode, and dynamic joystick properties
    - Fix InputControlsManager version check (String == to .equals())
    - Fix new asset profiles not appearing on existing installs (ID collision prevention)
    - Trackpad dead zone handling for cursor stability
    
    * refactor: use SettingsMenuLink directly for touchscreen mode row instead of modifying shared SettingsSwitchWithAction
    
    * Always show gear icon, fix two-finger tap, remove DYNAMIC_JOYSTICK type, rename SHOOTER_MODE to Dynamic Joysticks
    
    * Add Look Type setting to dynamic joysticks/shooter mode, look can be changed to gamepad right stick or mouse.
    
    Container-level Shooter Mode toggle has been added in the Edit Container > Controller section, it automatically replaces any joysticks with dynamic joysticks.
    
    * Addressed AI review issues
    
    * Updated default two finger action in RTS mode, changed shooter mode button labels
    
    * Added translations
    
    ---------
    
    Co-authored-by: Utkarsh Dalal <utkarsh.dalal@toptal.com>

diff --git a/app/src/main/java/app/gamenative/ui/screen/xserver/XServerScreen.kt b/app/src/main/java/app/gamenative/ui/screen/xserver/XServerScreen.kt
index df2ae38..ac309b5 100644
--- a/app/src/main/java/app/gamenative/ui/screen/xserver/XServerScreen.kt
+++ b/app/src/main/java/app/gamenative/ui/screen/xserver/XServerScreen.kt
@@ -871,6 +871,9 @@ fun XServerScreen(
                                 PluviaApp.touchpadView?.setTouchscreenMouseDisabled(true)
                             } else if (container.isTouchscreenMode()) {
                                 PluviaApp.touchpadView?.setTouchscreenMode(true)
+                                // Apply per-game gesture configuration
+                                val gestureConfig = app.gamenative.data.TouchGestureConfig.fromJson(container.getGestureConfig())
+                                PluviaApp.touchpadView?.setGestureConfig(gestureConfig)
                             }
                             Timber.d("WinHandler configured: preferredInputApi=%s, dinputMapperType=0x%02x", PreferredInputApi.values()[container.inputType], container.dinputMapperType)
                             // Timber.d("1 Container drives: ${container.drives}")
@@ -1047,6 +1050,9 @@ fun XServerScreen(
                 // Set overlay opacity from preferences if needed
                 val opacity = PrefManager.getFloat("controls_opacity", InputControlsView.DEFAULT_OVERLAY_OPACITY)
                 setOverlayOpacity(opacity)
+
+                // Set container-level shooter mode
+                setContainerShooterMode(container.isShooterMode)
             }
             PluviaApp.inputControlsView = icView
 
@@ -1281,9 +1287,25 @@ fun XServerScreen(
                                     newElement.setText(element.text)
                                     newElement.setIconId(element.iconId.toInt())
                                     newElement.setToggleSwitch(element.isToggleSwitch)
-                                    for (i in 0 until 4) {
+                                    // Copy range button properties â€” must set binding count
+                                    // BEFORE copying bindings, because setBindingCount resets
+                                    // the bindings array to NONE.
+                                    if (element.type == com.winlator.inputcontrols.ControlElement.Type.RANGE_BUTTON) {
+                                        newElement.setRange(element.range)
+                                        newElement.setOrientation(element.orientation)
+                                        newElement.setBindingCount(element.bindingCount)
+                                        newElement.isScrollLocked = element.isScrollLocked
+                                    }
+                                    for (i in 0 until element.bindingCount) {
                                         newElement.setBindingAt(i, element.getBindingAt(i))
                                     }
+                                    // Copy shooter mode properties
+                                    if (element.type == com.winlator.inputcontrols.ControlElement.Type.SHOOTER_MODE) {
+                                        newElement.shooterMovementType = element.shooterMovementType
+                                        newElement.shooterLookType = element.shooterLookType
+                                        newElement.shooterLookSensitivity = element.shooterLookSensitivity
+                                        newElement.shooterJoystickSize = element.shooterJoystickSize
+                                    }
                                     currentProfile.addElement(newElement)
                                 }
 
