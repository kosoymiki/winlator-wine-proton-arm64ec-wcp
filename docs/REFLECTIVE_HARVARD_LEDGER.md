# Reflective Harvard Ledger

This ledger is mandatory for the Magnum Opus integration track.  
Every logical stage must include explicit hypothesis, evidence, and validation.

## How to use

For each stage/patch set, add one row with concrete links to commits, logs, and files.
Do not leave placeholder text in completed rows.

## Record Template

| Stage | Scope | Hypothesis | Evidence | Counter-evidence | Decision | Impact | Verification | Owner | Date (UTC) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| `A1` | `runtime-contract` | Runtime plan unification lowers launch variance | `logcat bundle`, `forensics manifest` | One container still hangs on first launch | `rework` | Keep preflight hard gate, postpone profile auto-switch | `forensic-adb-complete-matrix.sh` + cold start x10 | `aero.so` | `2026-02-25` |
| `B3` | `translator-profile-migration` | Runtime profile-driven fallback from legacy presets reduces drift between requested and effective launch env | `ci/winlator/patches/0043-runtime-profile-translator-preset-migration-and-defaults.patch`, `docs/UNIFIED_RUNTIME_CONTRACT.md` | Risk of overriding intentionally old presets if migration is too aggressive | `accept` | Legacy defaults are mapped only for explicit non-`AUTO` runtime profiles; forensic now records requested/effective presets | `ci/winlator/check-patch-stack.sh` (43 patches) | `aero.so` | `2026-02-25` |
| `C1` | `gamenative-apk-runtime-matrix` | Correct focus prefixes for GN 0.7.2 expose actionable launch/graphics/runtime transfer signals for `pre-0044` | `/home/mikhail/gamenative-v0.7.2_reverse_20260225_143304/focus/focus_summary.txt`, `docs/GAMENATIVE_072_RUNTIME_TRANSFER_MATRIX.md`, `ci/research/extract-apk-runtime-focus.py`, `ci/research/build-gamenative-runtime-transfer-report.py` | Initial extraction with legacy-only prefixes (`Lcom/winemu/`, `Lcom/xj/winemu/`) produced zero focus classes/methods and invalid matrix | `accept` | Focus capture now includes `Lcom/winlator/` + `Lapp/gamenative/`; matrix quantifies launch (`630`), graphics (`366`), registry (`37`) and translator (`213`) method surfaces for targeted 0044 queue work | `ci/research/extract-apk-runtime-focus.py --apk /home/mikhail/gamenative-v0.7.2.apk`, `ci/research/build-gamenative-runtime-transfer-report.py` | `aero.so` | `2026-02-25` |
| `C2` | `gn-gh-patch-crosswalk` | Function-level crosswalk can identify safe patch merges between GameNative and GameHub without violating external-only policy | `docs/GAMENATIVE_072_RUNTIME_TRANSFER_MATRIX.md`, `docs/GAMEHUB_RUNTIME_TRANSFER_MATRIX.md`, `docs/GN_GH_PATCH_CROSSWALK.md`, `ci/research/build-gn-gh-patch-crosswalk.py` | Raw module overlap is noisy if token filters are too broad (false positives from generic UI/content names) | `accept` | Defined merge queue by shared behavior (`0044` launch, `0045` graphics, `0046` registry) and kept content/UI layers as research-only | `ci/research/build-gamehub-runtime-transfer-report.py`, `ci/research/build-gn-gh-patch-crosswalk.py` | `aero.so` | `2026-02-25` |
| `C3` | `launch-urc-bridge-0044` | A strict launch precheck bridge between activity and launcher can reduce route/shortcut drift crashes while preserving external-only runtime policy | `ci/winlator/patches/0044-runtime-launch-precheck-and-forensic-guardrails.patch`, `docs/GN_GH_PATCH_CROSSWALK.md` | Full Gradle compile in sandbox was blocked by environment limits (`SDK location` then Gradle daemon socket restrictions/download task), so runtime compile proof remains CI-only | `accept` | Added reason-coded launch precheck (`route/kind/target/reason/shell_fallback`) in `XServerDisplayActivity` + `GuestProgramLauncherComponent`, deterministic `wfm.exe` fallback for missing shortcut/empty command, and `WINLATOR_RUNTIME_PRESET_GUARD_REASON` forensic/env contract | `ci/winlator/check-patch-stack.sh` (44 patches, apply-pass), next verification in GitHub CI + adb forensic runs | `aero.so` | `2026-02-25` |
| `D1` | `bionic-donor-contract-hardening` | Preflight SHA/ABI verification of donor archives plus strict unix-ABI forensic checks will remove silent `glibc-unix` drift in mainline `bionic-native` packages | `ci/lib/winlator-runtime.sh`, `ci/lib/wcp_common.sh`, `ci/runtime-sources/bionic-source-map.json`, `ci/validation/check-urc-mainline-policy.sh`, `ci/validation/inspect-wcp-runtime-contract.sh` | Additional preflight and inspection logic can fail fast on donor/source-map mistakes and requires maintained SHA pins in workflows | `accept` | Mainline now enforces donor URL+SHA contract, caches/inspects donor archives, persists resolved donor hashes in forensic manifests, and hard-fails if strict bionic build retains `glibc-unix` modules | `bash ci/validation/check-urc-mainline-policy.sh`, `bash ci/validation/inspect-wcp-runtime-contract.sh <wcp> --strict-bionic`, package workflow preflight + inspection steps | `aero.so` | `2026-02-25` |
| `D2` | `runtime-forensic-mismatch-matrix` | Enforcing branch/time-bounded CI failure parsing plus scenario-level runtime mismatch matrix will reduce false triage and speed startup-hang root cause detection | `ci/validation/gh-latest-failures.sh`, `ci/winlator/forensic-adb-runtime-contract.sh`, `ci/winlator/forensic-runtime-mismatch-matrix.py`, `docs/CI_FAILURE_PLAYBOOK.md`, `README.md` | Runtime class / signal markers may still be absent in some device logs, so mismatch rows can contain `-` placeholders and require manual confirmation | `accept` | Added fresh-failure filtering (`branch + since_hours`) and a deterministic adb forensic pipeline that emits baseline-compared mismatch TSV/MD for `wine11/protonwine10/steven104` scenarios | `bash ci/validation/gh-latest-failures.sh 20 main 24`, `python3 ci/winlator/forensic-runtime-mismatch-matrix.py --help`, `bash -n ci/winlator/forensic-adb-runtime-contract.sh` | `aero.so` | `2026-02-26` |
| `D3` | `active-failure-triage-and-mismatch-severity` | Selecting only workflows whose latest run is failed and classifying runtime mismatch severity will cut stale-noise triage and prioritize actionable runtime drifts | `ci/validation/gh-latest-failures.sh`, `ci/winlator/forensic-runtime-mismatch-matrix.py`, `ci/winlator/forensic-adb-runtime-contract.sh`, `docs/CI_FAILURE_PLAYBOOK.md` | If GH run-list window is too small, a workflow may be missed; if device logs are sparse, severity defaults may require manual review | `accept` | Added active-failure workflow selection (latest-run status aware), mismatch status/severity/focus columns, and optional hard-fail mode (`WLT_FAIL_ON_MISMATCH=1`) for automated forensic gates | `bash ci/validation/gh-latest-failures.sh 5 main 24`, `python3 ci/winlator/forensic-runtime-mismatch-matrix.py --help`, `bash -n ci/winlator/forensic-adb-runtime-contract.sh`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-26` |
| `D4` | `critical-workflow-health-gate` | A dedicated mainline health command for critical workflows (`wine/protonge/protonwine/winlator`) reduces ambiguity before forensic deep-dives and prevents chasing already-fixed historical failures | `ci/validation/gh-mainline-health.sh`, `docs/CI_FAILURE_PLAYBOOK.md`, `docs/README.md`, `README.md` | Health check depends on GitHub API visibility window; if GH returns partial history, a workflow may be marked stale/missing and require rerun with wider limits | `accept` | Added explicit health snapshot/gate for the four critical workflows with `fresh + success` contract and fail-fast behavior (`WLT_REQUIRE_SUCCESS=1`) | `bash ci/validation/gh-mainline-health.sh`, `bash ci/validation/gh-mainline-health.sh main 24`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-26` |
| `D5` | `forensic-matrix-json-contract` | Emitting JSON for runtime mismatch matrix will enable machine-safe downstream analysis without reparsing markdown/tsv tables | `ci/winlator/forensic-runtime-mismatch-matrix.py`, `docs/CI_FAILURE_PLAYBOOK.md` | JSON and TSV/MD can diverge if fields are not sourced from the same row model; requires strict single-source generation | `accept` | Added `runtime-mismatch-matrix.json` output from the same row payload used by TSV/MD, preserving baseline metadata and status/severity/focus fields for automation | `python3 -m py_compile ci/winlator/forensic-runtime-mismatch-matrix.py`, `python3 ci/winlator/forensic-runtime-mismatch-matrix.py --help`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-26` |
| `D6` | `forensic-matrix-summary-counters` | Writing a deterministic summary counter file from mismatch rows will speed triage dashboards and reduce parsing complexity for automation | `ci/winlator/forensic-runtime-mismatch-matrix.py`, `docs/CI_FAILURE_PLAYBOOK.md` | Summary counters can become misleading if row status classification drifts; requires keeping status derivation and summary in same script | `accept` | Added `runtime-mismatch-matrix.summary.txt` with baseline, scenario count, status/severity distributions, and mismatch totals generated from the same in-memory rows used for TSV/MD/JSON outputs | `python3 -m py_compile ci/winlator/forensic-runtime-mismatch-matrix.py`, `python3 ci/winlator/forensic-runtime-mismatch-matrix.py --help`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-26` |
| `D7` | `runtime-orchestrator-summary-echo` | Printing summary counters directly at the end of adb runtime orchestration will reduce turnaround time when comparing container runs interactively | `ci/winlator/forensic-adb-runtime-contract.sh` | Console summary can hide full details if operators skip artifact files; still requires TSV/JSON inspection for deep diagnosis | `accept` | Added end-of-run summary echo from `runtime-mismatch-matrix.summary.txt` to make mismatch status visible immediately without opening output files | `bash -n ci/winlator/forensic-adb-runtime-contract.sh`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-26` |
| `D8` | `runtime-matrix-selftest-gate` | A deterministic local selftest for mismatch classification and fail-on-mismatch exit code will prevent silent regressions in forensic triage automation | `ci/winlator/selftest-runtime-mismatch-matrix.sh`, `ci/validation/check-urc-mainline-policy.sh`, `docs/CI_FAILURE_PLAYBOOK.md`, `AGENTS.md` | Synthetic fixture may not cover all real-device log variants; still requires periodic validation against live adb captures | `accept` | Added selftest script with fixture scenarios (`baseline`, `hang_after_submit`, `runtime_class_mismatch`), integrated it into URC policy gate, and documented it in ops docs/agent validation matrix | `bash ci/winlator/selftest-runtime-mismatch-matrix.sh`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-26` |
| `D9` | `adb-scenario-spec-hardening` | Strict validation of `WLT_SCENARIOS` format and deterministic label sanitization will prevent silent artifact-path corruption and ambiguous scenario mapping in adb forensic captures | `ci/winlator/forensic-adb-complete-matrix.sh`, `docs/CI_FAILURE_PLAYBOOK.md` | Label sanitization can collapse distinct labels into the same safe name; now explicitly guarded with duplicate-detection fail-fast | `accept` | Added fail-fast checks for malformed specs (`label:containerId`), numeric container-id enforcement, safe-label normalization, duplicate safe-label detection, and explicit `safe_label` trace in scenario metadata | `bash -n ci/winlator/forensic-adb-complete-matrix.sh`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-26` |
| `D10` | `mainline-health-export-contract` | Exporting critical workflow health snapshots as TSV/JSON will allow machine-driven gating/reporting without scraping console table output | `ci/validation/gh-mainline-health.sh`, `docs/CI_FAILURE_PLAYBOOK.md`, `docs/README.md` | Snapshot export can be stale if reused across sessions; operators must treat output as point-in-time and re-run before decisions | `accept` | Added optional `WLT_HEALTH_OUTPUT_PREFIX` output contract (`.tsv` + `.json`) while preserving fail-fast `fresh + success` gate behavior | `WLT_HEALTH_OUTPUT_PREFIX=/tmp/mainline-health bash ci/validation/gh-mainline-health.sh main 24`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-26` |
| `D11` | `active-failures-export-contract` | Exporting the selected active-failure workflow set to machine-readable files will make triage snapshots reproducible and scriptable | `ci/validation/gh-latest-failures.sh`, `docs/CI_FAILURE_PLAYBOOK.md`, `docs/README.md` | Export files can capture a transient zero-failure window and be misread later without timestamp/context; metadata includes branch/window/count to mitigate ambiguity | `accept` | Added optional `WLT_FAILURES_OUTPUT_PREFIX` contract that writes `.tsv` + `.meta` for active-failure selection while preserving existing log extraction flow | `WLT_FAILURES_OUTPUT_PREFIX=/tmp/gh-active-failures bash ci/validation/gh-latest-failures.sh 20 main 24`, `bash -n ci/validation/gh-latest-failures.sh`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-26` |
| `D12` | `one-shot-mainline-forensic-snapshot` | A single command to capture health, active failures, URC status, and git metadata will reduce operator drift during rapid triage loops | `ci/validation/collect-mainline-forensic-snapshot.sh`, `ci/validation/gh-mainline-health.sh`, `ci/validation/gh-latest-failures.sh`, `ci/validation/check-urc-mainline-policy.sh`, `docs/CI_FAILURE_PLAYBOOK.md` | Initial active-failures implementation passed large JSON via env and hit `Argument list too long`; switched to temp-file handoff for robust large-window operation | `accept` | Added snapshot orchestrator and stabilized active-failures parser input path; snapshot now reliably emits consolidated logs/artifacts and status metadata for triage handoff | `WLT_SNAPSHOT_DIR=/tmp/mainline-forensic-snapshot bash ci/validation/collect-mainline-forensic-snapshot.sh`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-27` |
| `D13` | `runtime-matrix-patch-routing` | Adding a deterministic `patch_hint` column and explicit `runtime_guard_blocked` classification will shorten the path from log drift to concrete code fix files | `ci/winlator/forensic-runtime-mismatch-matrix.py`, `ci/winlator/selftest-runtime-mismatch-matrix.sh`, `docs/CI_FAILURE_PLAYBOOK.md`, `docs/README.md` | Hints can drift if file ownership changes; selftest now validates status/severity/hint tuple to catch stale routing strings early | `accept` | Runtime mismatch outputs now include file-level patch routing for each classified failure and detect explicit runtime guard blocks before generic mismatch handling | `bash ci/winlator/selftest-runtime-mismatch-matrix.sh`, `python3 -m py_compile ci/winlator/forensic-runtime-mismatch-matrix.py`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-27` |
| `D14` | `runtime-orchestrator-actionable-echo` | Printing concise actionable drift rows directly after matrix generation will reduce time-to-fix during live adb sessions | `ci/winlator/forensic-adb-runtime-contract.sh`, `docs/CI_FAILURE_PLAYBOOK.md` | Console-only output can be missed in long terminal sessions; full matrix artifacts remain the source of truth and include the same data | `accept` | `forensic-adb-runtime-contract.sh` now emits per-row `status|severity|label|patch_hint|mismatch_keys` lines for all non-baseline drifts immediately after summary output | `bash -n ci/winlator/forensic-adb-runtime-contract.sh`, `bash ci/winlator/selftest-runtime-mismatch-matrix.sh`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-27` |
| `D15` | `gh-health-large-payload-hardening` | Moving `gh run list` payload transfer from env var to temp-file handoff prevents shell/env-size failures during high-volume run history windows | `ci/validation/gh-mainline-health.sh` | Introduces temporary file lifecycle complexity; mitigated with `trap` cleanup and explicit UTF-8 read path in Python | `accept` | `gh-mainline-health.sh` now writes run JSON to temp file and parses it from Python arguments, matching hardened failure-parser pattern and reducing payload fragility | `bash -n ci/validation/gh-mainline-health.sh`, `bash ci/validation/gh-mainline-health.sh main 24`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-27` |
| `D16` | `active-failure-tempfile-cleanup` | Adding explicit temp-file lifecycle handling in active-failure triage prevents stale `/tmp` growth and keeps repeated automation runs deterministic | `ci/validation/gh-latest-failures.sh` | Cleanup logic can mask earlier parser failures if trap handling is wrong; validated by preserving fail-fast behavior and explicit post-parse `trap - EXIT` | `accept` | `gh-latest-failures.sh` now registers a cleanup trap for its temporary run-list JSON and releases the trap after successful parse handoff | `bash -n ci/validation/gh-latest-failures.sh`, `bash ci/validation/gh-latest-failures.sh 5 main 24`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-27` |
| `D17` | `urc-policy-feature-lock` | URC policy should explicitly assert new forensic routing capabilities so future edits cannot silently remove actionable triage fields | `ci/validation/check-urc-mainline-policy.sh`, `ci/winlator/forensic-runtime-mismatch-matrix.py`, `ci/winlator/forensic-adb-runtime-contract.sh` | Pattern-based checks can pass on stale strings if semantics diverge; mitigated by retaining runtime selftest execution in the same gate | `accept` | Added URC checks for `patch_hint`, `runtime_guard_blocked`, and actionable drift echo contract in forensic orchestrator | `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-27` |
| `D18` | `run-scoped-root-cause-triage` | A dedicated run-level triage command should reduce diagnosis latency by extracting failed-job root causes for one run without manual GH job hopping | `ci/validation/gh-run-root-cause.sh`, `ci/validation/extract-gh-job-failures.sh`, `docs/CI_FAILURE_PLAYBOOK.md`, `docs/README.md` | Per-run triage artifacts can be verbose; summary TSV is added to keep routing concise while preserving full job analyses for deep follow-up | `accept` | Added run-id/url triage command producing failed-job inventory, per-job analyses, and `root-cause-summary.tsv`; wired into docs and URC policy file/executable checks | `bash -n ci/validation/gh-run-root-cause.sh`, `bash ci/validation/gh-run-root-cause.sh 22455358438`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-27` |
| `D19` | `snapshot-active-run-deep-triage` | Enabling optional per-run triage inside the one-shot snapshot command should produce complete forensic bundles in a single invocation during active incident windows | `ci/validation/collect-mainline-forensic-snapshot.sh`, `ci/validation/gh-run-root-cause.sh`, `docs/CI_FAILURE_PLAYBOOK.md`, `ci/validation/check-urc-mainline-policy.sh` | Full triage can increase GH API usage/time; feature is opt-in (`WLT_TRIAGE_ACTIVE_RUNS=1`) and bounded by `WLT_TRIAGE_MAX_RUNS/WLT_TRIAGE_MAX_JOBS` | `accept` | Snapshot flow now supports optional deep triage of active failed runs and records `triage_rc` in status metadata for strict pass/fail accounting | `bash -n ci/validation/collect-mainline-forensic-snapshot.sh`, `WLT_TRIAGE_ACTIVE_RUNS=1 bash ci/validation/collect-mainline-forensic-snapshot.sh`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-27` |
| `D20` | `gh-prefixed-log-marker-normalization` | Root-cause extraction must handle `gh run view --job --log` prefixed log format to avoid false `no_explicit_marker` outcomes on failed runs | `ci/validation/extract-gh-job-failures.sh`, `ci/validation/gh-run-root-cause.sh` | Broader marker regex can capture noisy non-fatal lines; mitigated by prioritizing hard markers (`##[error]`, `Process completed with exit code`, compiler `error:`) and summary normalization | `accept` | Updated failure marker regexes for GH-prefixed logs and normalized root-cause summary fields to stable single-line TSV entries | `bash -n ci/validation/extract-gh-job-failures.sh`, `bash ci/validation/gh-run-root-cause.sh 22446750044 1`, `bash ci/validation/check-urc-mainline-policy.sh` | `aero.so` | `2026-02-27` |

## Decision Codes

- `accept` - implementation validated and promoted to mainline.
- `rework` - concept is kept, implementation changes required.
- `reject` - not compatible with external-only mainline policy.

## Required Artifacts Per Row

- commit SHA(s)
- affected patch IDs
- forensic evidence path(s)
- explicit regression result (pass/fail)
