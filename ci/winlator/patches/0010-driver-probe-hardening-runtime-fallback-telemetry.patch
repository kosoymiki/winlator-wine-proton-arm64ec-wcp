diff --git a/app/src/main/java/com/winlator/cmod/XServerDisplayActivity.java b/app/src/main/java/com/winlator/cmod/XServerDisplayActivity.java
index b7bbcbe..e5cc6a4 100644
--- a/app/src/main/java/com/winlator/cmod/XServerDisplayActivity.java
+++ b/app/src/main/java/com/winlator/cmod/XServerDisplayActivity.java
@@ -83,13 +83,14 @@ import com.winlator.cmod.core.WineRequestHandler;
 import com.winlator.cmod.core.WineStartMenuCreator;
 import com.winlator.cmod.core.WineThemeManager;
 import com.winlator.cmod.core.WineUtils;
-import com.winlator.cmod.inputcontrols.ControlsProfile;
-import com.winlator.cmod.inputcontrols.ExternalController;
-import com.winlator.cmod.inputcontrols.InputControlsManager;
-import com.winlator.cmod.math.Mathf;
-import com.winlator.cmod.math.XForm;
-import com.winlator.cmod.midi.MidiHandler;
-import com.winlator.cmod.midi.MidiManager;
+import com.winlator.cmod.inputcontrols.ControlsProfile;
+import com.winlator.cmod.inputcontrols.ExternalController;
+import com.winlator.cmod.inputcontrols.InputControlsManager;
+import com.winlator.cmod.graphics.DriverProbeResult;
+import com.winlator.cmod.math.Mathf;
+import com.winlator.cmod.math.XForm;
+import com.winlator.cmod.midi.MidiHandler;
+import com.winlator.cmod.midi.MidiManager;
 import com.winlator.cmod.renderer.GLRenderer;
 import com.winlator.cmod.renderer.effects.CRTEffect;
 import com.winlator.cmod.renderer.effects.ColorEffect;
@@ -1595,12 +1596,15 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
         inputControlsView.invalidate();
     }
 
-    private void extractGraphicsDriverFiles() {
-        String adrenoToolsDriverId = graphicsDriverConfig.get("version");
-
-        Log.d("GraphicsDriverExtraction", "Adrenotools DriverID: " + adrenoToolsDriverId);
-
-        File rootDir = imageFs.getRootDir();
+    private void extractGraphicsDriverFiles() {
+        String adrenoToolsDriverId = graphicsDriverConfig.get("version");
+        if (adrenoToolsDriverId == null || adrenoToolsDriverId.trim().isEmpty()) {
+            adrenoToolsDriverId = "System";
+        }
+
+        Log.d("GraphicsDriverExtraction", "Adrenotools DriverID: " + adrenoToolsDriverId);
+
+        File rootDir = imageFs.getRootDir();
 
         if (dxwrapper.contains("dxvk")) {
             DXVKConfigDialog.setEnvVars(this, dxwrapperConfig, envVars);
@@ -1636,18 +1640,36 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
         }
 
         if (firstTimeBoot) {
-            Log.d("XServerDisplayActivity", "First time container boot, re-extracting libs");
-            TarCompressorUtils.extract(TarCompressorUtils.Type.ZSTD, this, "graphics_driver/wrapper" + ".tzst", rootDir);
-            TarCompressorUtils.extract(TarCompressorUtils.Type.ZSTD, this, "layers" + ".tzst", rootDir);
-            TarCompressorUtils.extract(TarCompressorUtils.Type.ZSTD, this, "graphics_driver/extra_libs" + ".tzst", rootDir);
-            if (wineInfo.isArm64EC() && !GPUInformation.getRenderer(null,null).contains("Mali"))
-                TarCompressorUtils.extract(TarCompressorUtils.Type.ZSTD, this, "graphics_driver/zink_dlls" + ".tzst", new File(rootDir, imageFs.WINEPREFIX + "/drive_c/windows"));
-        }
-
-        if (adrenoToolsDriverId != "System") {
-            AdrenotoolsManager adrenotoolsManager = new AdrenotoolsManager(this);
-            adrenotoolsManager.setDriverById(envVars, imageFs, adrenoToolsDriverId);
+            Log.d("XServerDisplayActivity", "First time container boot, re-extracting libs");
+            TarCompressorUtils.extract(TarCompressorUtils.Type.ZSTD, this, "graphics_driver/wrapper" + ".tzst", rootDir);
+            TarCompressorUtils.extract(TarCompressorUtils.Type.ZSTD, this, "layers" + ".tzst", rootDir);
+            TarCompressorUtils.extract(TarCompressorUtils.Type.ZSTD, this, "graphics_driver/extra_libs" + ".tzst", rootDir);
+            if (wineInfo.isArm64EC() && !GPUInformation.getRenderer(null,null).contains("Mali"))
+                TarCompressorUtils.extract(TarCompressorUtils.Type.ZSTD, this, "graphics_driver/zink_dlls" + ".tzst", new File(rootDir, imageFs.WINEPREFIX + "/drive_c/windows"));
         }
+
+        AdrenotoolsManager adrenotoolsManager = new AdrenotoolsManager(this);
+        DriverProbeResult driverProbe = adrenotoolsManager.probeDriver(adrenoToolsDriverId);
+        boolean useSystemVulkan = driverProbe.isUsingSystemVulkan() || !driverProbe.isUsable();
+
+        Log.d("GraphicsDriverExtraction", "Driver probe -> " + driverProbe.summarize());
+        ForensicLogger.logEvent(this, useSystemVulkan ? "warn" : "info", "RUNTIME_DRIVER_PROBE",
+                forensicTraceId, "graphics_driver",
+                useSystemVulkan ? "driver probe fallback" : "driver probe usable",
+                ForensicLogger.fields(
+                        "requested_driver_id", driverProbe.getRequestedDriverId(),
+                        "selected_driver_id", driverProbe.getSelectedDriverId(),
+                        "driver_probe_status", driverProbe.isUsable() ? "usable" : "fallback",
+                        "driver_probe_summary", driverProbe.summarize()));
+
+        if (driverProbe.isUsable()) {
+            adrenotoolsManager.setDriverByProbe(envVars, imageFs, driverProbe);
+        } else if (!driverProbe.getRejectionReasons().isEmpty()) {
+            envVars.put("WINLATOR_DRIVER_FALLBACK_REASON", driverProbe.getRejectionReasons().toString());
+        }
+
+        envVars.put("WINLATOR_DRIVER_SELECTED", driverProbe.getSelectedDriverId());
+        envVars.put("WINLATOR_DRIVER_PROBE_STATUS", driverProbe.isUsable() ? "usable" : "fallback");
         if (preferences.getBoolean("enable_turnip_logs", false)) {
             File mesaLogFile = WinlatorLogUtils.createTimestampedLogFile(this, "turnip_mesa");
             envVars.put("MESA_LOG_FILE", mesaLogFile.getAbsolutePath());
@@ -1655,14 +1677,21 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
                 envVars.put("MESA_DEBUG", "1");
             }
         }
-
-        String vulkanVersion = graphicsDriverConfig.get("vulkanVersion");
-        String vulkanVersionPatch = GPUInformation.getVulkanVersion(adrenoToolsDriverId, this).split("\\.")[2];
-        vulkanVersion = vulkanVersion + "." + vulkanVersionPatch;
-        envVars.put("WRAPPER_VK_VERSION", vulkanVersion);
-
-        String blacklistedExtensions = graphicsDriverConfig.get("blacklistedExtensions");
-        envVars.put("WRAPPER_EXTENSION_BLACKLIST", blacklistedExtensions);
+
+        String vulkanVersion = graphicsDriverConfig.get("vulkanVersion");
+        if (vulkanVersion == null || vulkanVersion.isEmpty()) {
+            vulkanVersion = "1.3";
+        }
+        String versionProbeDriverId = useSystemVulkan ? "System" : driverProbe.getSelectedDriverId();
+        String detectedVkVersion = GPUInformation.getVulkanVersion(versionProbeDriverId, this);
+        int[] detectedVkParts = parseSemverLoose(detectedVkVersion);
+        String vulkanVersionPatch = String.valueOf(detectedVkParts[2]);
+        vulkanVersion = vulkanVersion + "." + vulkanVersionPatch;
+        envVars.put("WRAPPER_VK_VERSION", vulkanVersion);
+        envVars.put("WINLATOR_DETECTED_VK_VERSION", detectedVkVersion == null ? "" : detectedVkVersion);
+
+        String blacklistedExtensions = graphicsDriverConfig.get("blacklistedExtensions");
+        envVars.put("WRAPPER_EXTENSION_BLACKLIST", blacklistedExtensions != null ? blacklistedExtensions : "");
 
         String gpuName = graphicsDriverConfig.get("gpuName");
         if (!gpuName.equals("Device")) {
diff --git a/app/src/main/java/com/winlator/cmod/contents/AdrenotoolsManager.java b/app/src/main/java/com/winlator/cmod/contents/AdrenotoolsManager.java
index 06396fe..fdefd24 100644
--- a/app/src/main/java/com/winlator/cmod/contents/AdrenotoolsManager.java
+++ b/app/src/main/java/com/winlator/cmod/contents/AdrenotoolsManager.java
@@ -16,6 +16,7 @@ import com.winlator.cmod.core.FileUtils;
 import com.winlator.cmod.core.GPUInformation;
 import com.winlator.cmod.contentdialog.GraphicsDriverConfigDialog;
 import com.winlator.cmod.core.TarCompressorUtils;
+import com.winlator.cmod.graphics.DriverProbeResult;
 import com.winlator.cmod.xenvironment.ImageFs;
 import java.io.File;
 import java.io.IOException;
@@ -42,42 +43,18 @@ public class AdrenotoolsManager {
     }
         
     public String getLibraryName(String adrenoToolsDriverId) {
-        String libraryName = "";
-        File driverPath = new File(adrenotoolsContentDir, adrenoToolsDriverId);
-        try {
-            File metaProfile = new File(driverPath, "meta.json");
-            JSONObject jsonObject = new JSONObject(FileUtils.readString(metaProfile));
-            libraryName = jsonObject.getString("libraryName");
-        }
-        catch (JSONException e) {
-        }
-        return libraryName;
+        if (isSystemDriverId(adrenoToolsDriverId)) return "";
+        return readMetaField(new File(adrenotoolsContentDir, adrenoToolsDriverId), "libraryName");
     }
     
     public String getDriverName(String adrenoToolsDriverId) {
-        String driverName = "";
-        File driverPath = new File(adrenotoolsContentDir, adrenoToolsDriverId);
-        try {
-            File metaProfile = new File(driverPath, "meta.json");
-            JSONObject jsonObject = new JSONObject(FileUtils.readString(metaProfile));
-            driverName = jsonObject.getString("name");
-        }
-        catch (JSONException e) {
-        }
-        return driverName;
+        if (isSystemDriverId(adrenoToolsDriverId)) return "";
+        return readMetaField(new File(adrenotoolsContentDir, adrenoToolsDriverId), "name");
     }
 
     public String getDriverVersion(String adrenoToolsDriverId) {
-        String driverVersion = "";
-        File driverPath = new File(adrenotoolsContentDir, adrenoToolsDriverId);
-        try {
-            File metaProfile = new File(driverPath, "meta.json");
-            JSONObject jsonObject = new JSONObject(FileUtils.readString(metaProfile));
-            driverVersion = jsonObject.getString("driverVersion");
-        }
-        catch (JSONException e) {
-        }
-        return driverVersion;
+        if (isSystemDriverId(adrenoToolsDriverId)) return "";
+        return readMetaField(new File(adrenotoolsContentDir, adrenoToolsDriverId), "driverVersion");
     }
 
     public String getDriverPath(String adrenotoolsDriverId) {
@@ -88,8 +65,10 @@ public class AdrenotoolsManager {
         ContainerManager containerManager = new ContainerManager(mContext);
         for (Container container : containerManager.getContainers()) {
             HashMap<String, String> config = GraphicsDriverConfigDialog.parseGraphicsDriverConfig(container.getGraphicsDriverConfig());
-            Log.d("AdrenotoolsManager", "Checking if container driver version " + config.get("version") + " matches " + getDriverName(adrenoToolsDriverId));
-            if (config.get("version").contains(getDriverName(adrenoToolsDriverId))) {
+            String containerVersion = config.get("version");
+            String removedDriverName = getDriverName(adrenoToolsDriverId);
+            Log.d("AdrenotoolsManager", "Checking if container driver version " + containerVersion + " matches " + removedDriverName);
+            if (containerVersion != null && removedDriverName != null && !removedDriverName.isEmpty() && containerVersion.contains(removedDriverName)) {
                 Log.d("AdrenotoolsManager", "Found a match for container " + container.getName());
                 config.put("version", GPUInformation.isDriverSupported(DefaultVersion.WRAPPER_ADRENO, mContext) ? DefaultVersion.WRAPPER_ADRENO : DefaultVersion.WRAPPER);
                 container.setGraphicsDriverConfig(GraphicsDriverConfigDialog.toGraphicsDriverConfig(config));
@@ -98,8 +77,10 @@ public class AdrenotoolsManager {
         }
         for (Shortcut shortcut : containerManager.loadShortcuts()) {
             HashMap<String, String> config = GraphicsDriverConfigDialog.parseGraphicsDriverConfig(shortcut.getExtra("graphicsDriverConfig", shortcut.container.getGraphicsDriverConfig()));
-            Log.d("AdrenotoolsManager", "Checking if shortcut driver version " + config.get("version") + " matches " + getDriverName(adrenoToolsDriverId));
-            if (config.get("version").contains(getDriverName(adrenoToolsDriverId))) {
+            String shortcutVersion = config.get("version");
+            String removedDriverName = getDriverName(adrenoToolsDriverId);
+            Log.d("AdrenotoolsManager", "Checking if shortcut driver version " + shortcutVersion + " matches " + removedDriverName);
+            if (shortcutVersion != null && removedDriverName != null && !removedDriverName.isEmpty() && shortcutVersion.contains(removedDriverName)) {
                 Log.d("AdrenotoolsManager", "Found a match for shortcut " + shortcut.name);
                 config.put("version", GPUInformation.isDriverSupported(DefaultVersion.WRAPPER_ADRENO, mContext) ? DefaultVersion.WRAPPER_ADRENO : DefaultVersion.WRAPPER);
                 shortcut.putExtra("graphicsDriverConfig", GraphicsDriverConfigDialog.toGraphicsDriverConfig(config));
@@ -117,8 +98,12 @@ public class AdrenotoolsManager {
 
     public ArrayList<String> enumarateInstalledDrivers() {
         ArrayList<String> driversList = new ArrayList<>();
-        
-        for (File f : adrenotoolsContentDir.listFiles()) {
+
+        File[] files = adrenotoolsContentDir.listFiles();
+        if (files == null) return driversList;
+
+        for (File f : files) {
+            if (f == null || !f.isDirectory()) continue;
             boolean fromResources = isFromResources(f.getName());
             if (!fromResources && new File(f, "meta.json").exists())
                 driversList.add(f.getName());
@@ -253,21 +238,85 @@ public class AdrenotoolsManager {
     }
     
     public void setDriverById(EnvVars envVars, ImageFs imagefs, String adrenotoolsDriverId) {
-        boolean isFromResources = isFromResources(adrenotoolsDriverId);
+        setDriverByProbe(envVars, imagefs, probeDriver(adrenotoolsDriverId));
+    }
 
-        if (isFromResources || enumarateInstalledDrivers().contains(adrenotoolsDriverId)) {
-            String driverPath = getDriverPath(adrenotoolsDriverId);
+    public void setDriverByProbe(EnvVars envVars, ImageFs imagefs, DriverProbeResult probeResult) {
+        if (probeResult == null || !probeResult.isUsable()) return;
 
-            if (!getLibraryName(adrenotoolsDriverId).equals("")) {
-                envVars.put("ADRENOTOOLS_DRIVER_PATH", driverPath);
-                envVars.put("ADRENOTOOLS_HOOKS_PATH", imagefs.getLibDir());
-                envVars.put("ADRENOTOOLS_DRIVER_NAME", getLibraryName(adrenotoolsDriverId));
+        envVars.put("ADRENOTOOLS_DRIVER_PATH", probeResult.getDriverPath());
+        envVars.put("ADRENOTOOLS_HOOKS_PATH", imagefs.getLibDir());
+        envVars.put("ADRENOTOOLS_DRIVER_NAME", probeResult.getLibraryName());
+
+        File winlatorDir = new File(SettingsFragment.DEFAULT_WINLATOR_PATH);
+        File qglConfig = new File(winlatorDir, "qgl_config.txt");
+        if (qglConfig.exists())
+            envVars.put("ADRENOTOOLS_REDIRECT_DIR", winlatorDir.getAbsolutePath() + "/");
+    }
 
-                File winlatorDir = new File(SettingsFragment.DEFAULT_WINLATOR_PATH);
-                File qglConfig = new File(winlatorDir, "qgl_config.txt");
-                if (qglConfig.exists())
-                    envVars.put("ADRENOTOOLS_REDIRECT_DIR", winlatorDir.getAbsolutePath() + "/");
+    public DriverProbeResult probeDriver(String adrenotoolsDriverId) {
+        DriverProbeResult result = new DriverProbeResult(adrenotoolsDriverId);
+
+        if (isSystemDriverId(adrenotoolsDriverId)) {
+            result.setSelectedDriverId("System");
+            result.setUsingSystemVulkan(true);
+            result.setFound(true);
+            return result;
+        }
+
+        boolean fromResources = isFromResources(adrenotoolsDriverId);
+        boolean installed = enumarateInstalledDrivers().contains(adrenotoolsDriverId);
+        if (!fromResources && !installed) {
+            result.reject("driver id is not available");
+            return result;
+        }
+
+        if (fromResources) {
+            File extractedDir = new File(adrenotoolsContentDir, adrenotoolsDriverId);
+            if (!extractedDir.exists() && !extractDriverFromResources(adrenotoolsDriverId)) {
+                result.reject("failed to extract resource driver");
+                return result;
             }
         }
+
+        String driverPath = getDriverPath(adrenotoolsDriverId);
+        result.setSelectedDriverId(adrenotoolsDriverId);
+        result.setDriverPath(driverPath);
+
+        File driverDir = new File(driverPath);
+        if (!driverDir.exists() || !driverDir.isDirectory()) {
+            result.reject("driver directory missing");
+            return result;
+        }
+
+        String libraryName = getLibraryName(adrenotoolsDriverId);
+        if (libraryName == null || libraryName.isEmpty()) {
+            result.reject("meta.json missing libraryName");
+            return result;
+        }
+
+        result.setLibraryName(libraryName);
+        result.setUsingSystemVulkan(false);
+        result.setFound(true);
+        return result;
+    }
+
+    private boolean isSystemDriverId(String adrenotoolsDriverId) {
+        return adrenotoolsDriverId == null
+                || adrenotoolsDriverId.trim().isEmpty()
+                || "System".equalsIgnoreCase(adrenotoolsDriverId.trim());
+    }
+
+    private String readMetaField(File driverPath, String fieldName) {
+        if (driverPath == null || fieldName == null || fieldName.isEmpty()) return "";
+        File metaProfile = new File(driverPath, "meta.json");
+        if (!metaProfile.exists() || !metaProfile.isFile()) return "";
+        try {
+            JSONObject jsonObject = new JSONObject(FileUtils.readString(metaProfile));
+            return jsonObject.optString(fieldName, "");
+        }
+        catch (Exception e) {
+            return "";
+        }
     }
  }
diff --git a/app/src/main/java/com/winlator/cmod/graphics/DriverProbeResult.java b/app/src/main/java/com/winlator/cmod/graphics/DriverProbeResult.java
new file mode 100644
index 0000000..17a1838
--- /dev/null
+++ b/app/src/main/java/com/winlator/cmod/graphics/DriverProbeResult.java
@@ -0,0 +1,92 @@
+package com.winlator.cmod.graphics;
+
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.List;
+
+public class DriverProbeResult {
+    private final String requestedDriverId;
+    private String selectedDriverId = "System";
+    private String driverPath = "";
+    private String libraryName = "";
+    private boolean usingSystemVulkan = true;
+    private boolean found;
+    private final ArrayList<String> rejectionReasons = new ArrayList<>();
+
+    public DriverProbeResult(String requestedDriverId) {
+        this.requestedDriverId = requestedDriverId != null ? requestedDriverId : "";
+    }
+
+    public String getRequestedDriverId() {
+        return requestedDriverId;
+    }
+
+    public String getSelectedDriverId() {
+        return selectedDriverId;
+    }
+
+    public void setSelectedDriverId(String selectedDriverId) {
+        if (selectedDriverId != null && !selectedDriverId.isEmpty()) {
+            this.selectedDriverId = selectedDriverId;
+        }
+    }
+
+    public String getDriverPath() {
+        return driverPath;
+    }
+
+    public void setDriverPath(String driverPath) {
+        this.driverPath = driverPath != null ? driverPath : "";
+    }
+
+    public String getLibraryName() {
+        return libraryName;
+    }
+
+    public void setLibraryName(String libraryName) {
+        this.libraryName = libraryName != null ? libraryName : "";
+    }
+
+    public boolean isUsingSystemVulkan() {
+        return usingSystemVulkan;
+    }
+
+    public void setUsingSystemVulkan(boolean usingSystemVulkan) {
+        this.usingSystemVulkan = usingSystemVulkan;
+    }
+
+    public boolean isFound() {
+        return found;
+    }
+
+    public void setFound(boolean found) {
+        this.found = found;
+    }
+
+    public void reject(String reason) {
+        if (reason != null && !reason.isEmpty()) {
+            rejectionReasons.add(reason);
+        }
+    }
+
+    public List<String> getRejectionReasons() {
+        return Collections.unmodifiableList(rejectionReasons);
+    }
+
+    public boolean isUsable() {
+        return found && !usingSystemVulkan && !libraryName.isEmpty();
+    }
+
+    public String summarize() {
+        StringBuilder builder = new StringBuilder();
+        builder.append("requested=").append(requestedDriverId.isEmpty() ? "<empty>" : requestedDriverId);
+        builder.append(", selected=").append(selectedDriverId);
+        builder.append(", usingSystem=").append(usingSystemVulkan);
+        builder.append(", found=").append(found);
+        builder.append(", lib=").append(libraryName.isEmpty() ? "<none>" : libraryName);
+        if (!rejectionReasons.isEmpty()) {
+            builder.append(", reasons=").append(rejectionReasons);
+        }
+        return builder.toString();
+    }
+}
