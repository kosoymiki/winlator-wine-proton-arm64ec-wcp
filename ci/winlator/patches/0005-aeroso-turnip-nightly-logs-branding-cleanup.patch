From 179ba64d93e2801f388b652357ae2d45ffdf1f95 Mon Sep 17 00:00:00 2001
From: Codex <codex@local>
Date: Tue, 24 Feb 2026 03:01:26 +0300
Subject: [PATCH] winlator: aeroso turnip/nightly/logs branding cleanup
 (rebased contexts)

---
 app/src/main/AndroidManifest.xml              |  16 +-
 .../winlator/cmod/AdrenotoolsFragment.java    | 322 ++++++++----
 .../com/winlator/cmod/ContentsFragment.java   | 319 +++++++-----
 .../com/winlator/cmod/SettingsFragment.java   |  21 +-
 .../winlator/cmod/XServerDisplayActivity.java | 490 +++++++++++-------
 .../cmod/contents/AdrenotoolsManager.java     | 110 ++--
 .../cmod/contents/ContentsManager.java        |  92 ++--
 .../winlator/cmod/core/FileDebugLogger.java   |  39 ++
 .../com/winlator/cmod/core/ProcessHelper.java |  29 +-
 .../winlator/cmod/core/WinlatorLogUtils.java  |  40 ++
 .../com/winlator/cmod/widget/LogView.java     |  34 +-
 .../GuestProgramLauncherComponent.java        | 160 ++++--
 .../main/res/layout/adrenotools_fragment.xml  |  23 +-
 app/src/main/res/layout/contents_fragment.xml |  45 +-
 app/src/main/res/layout/settings_fragment.xml |  35 +-
 app/src/main/res/values/colors.xml            |  24 +-
 app/src/main/res/values/strings.xml           |  52 +-
 app/src/main/res/values/styles.xml            |  84 ++-
 18 files changed, 1238 insertions(+), 697 deletions(-)
 create mode 100644 app/src/main/java/com/winlator/cmod/core/FileDebugLogger.java
 create mode 100644 app/src/main/java/com/winlator/cmod/core/WinlatorLogUtils.java

diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
index d61aada..9338ac2 100644
--- a/app/src/main/AndroidManifest.xml
+++ b/app/src/main/AndroidManifest.xml
@@ -38,8 +38,8 @@
         tools:ignore="ProtectedPermissions" />
     <uses-permission android:name="android.permission.POST_NOTIFICATIONS"/>
 
-    <application
-        android:label="Winlator CMOD"
+    <application
+        android:label="@string/app_name"
         android:icon="@mipmap/ic_launcher"
         android:roundIcon="@mipmap/ic_launcher_round"
         android:theme="@style/AppTheme"
@@ -117,14 +117,14 @@
             android:name=".ShortcutBroadcastReceiver"
             android:exported="true">
             <intent-filter>
-                <action android:name="com.winlator.cmod.SHORTCUT_ADDED" />
+                <action android:name="com.winlator.cmod.SHORTCUT_ADDED" />
             </intent-filter>
         </receiver>
 
         <!-- FileProvider for sharing files -->
         <provider
             android:name="androidx.core.content.FileProvider"
-            android:authorities="com.winlator.cmod.tileprovider"
+            android:authorities="${applicationId}.tileprovider"
             android:exported="false"
             android:grantUriPermissions="true">
             <meta-data
@@ -135,7 +135,7 @@
         <!-- Provider for Winlator’s DocumentProvider or similar usage -->
         <provider
             android:name=".core.WinlatorFilesProvider"
-            android:authorities="com.winlator.cmod.core.WinlatorFilesProvider"
+            android:authorities="${applicationId}.core.WinlatorFilesProvider"
             android:exported="true"
             android:grantUriPermissions="true"
             android:permission="android.permission.MANAGE_DOCUMENTS">
@@ -156,8 +156,6 @@
         <meta-data
             android:name="android.allow_multiple_resumed_activities"
             android:value="true" />
-        >
-
-    </application>
-</manifest>
+    </application>
+</manifest>
 
diff --git a/app/src/main/java/com/winlator/cmod/AdrenotoolsFragment.java b/app/src/main/java/com/winlator/cmod/AdrenotoolsFragment.java
index 3c3cf2c..8698096 100644
--- a/app/src/main/java/com/winlator/cmod/AdrenotoolsFragment.java
+++ b/app/src/main/java/com/winlator/cmod/AdrenotoolsFragment.java
@@ -1,174 +1,301 @@
 package com.winlator.cmod;
 
 import android.app.Activity;
+import android.app.AlertDialog;
 import android.content.Intent;
 import android.net.Uri;
-import com.winlator.cmod.R;
-
 import android.os.Bundle;
+import android.text.format.DateFormat;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
 import android.widget.ImageButton;
 import android.widget.TextView;
+
+import androidx.annotation.NonNull;
 import androidx.appcompat.app.AppCompatActivity;
 import androidx.fragment.app.Fragment;
 import androidx.recyclerview.widget.DividerItemDecoration;
 import androidx.recyclerview.widget.LinearLayoutManager;
 import androidx.recyclerview.widget.RecyclerView;
+
 import com.winlator.cmod.contentdialog.ContentDialog;
 import com.winlator.cmod.contents.AdrenotoolsManager;
 import com.winlator.cmod.contents.Downloader;
 import com.winlator.cmod.core.AppUtils;
+import com.winlator.cmod.core.DownloadProgressDialog;
+import com.winlator.cmod.core.FileUtils;
+
 import org.json.JSONArray;
 import org.json.JSONObject;
+
+import java.io.BufferedInputStream;
 import java.io.File;
+import java.io.FileOutputStream;
+import java.io.InputStream;
+import java.io.OutputStream;
+import java.net.URL;
+import java.net.URLConnection;
 import java.util.ArrayList;
+import java.util.Date;
 
 public class AdrenotoolsFragment extends Fragment {
-
-    private static final String TURNIP_RELEASES_API = "https://api.github.com/repos/StevenMXZ/freedreno_turnip-CI/releases?per_page=12";
-
-    private static class TurnipAsset {
-        private final String label;
-        private final String fileName;
-        private final String downloadUrl;
-
-        private TurnipAsset(String label, String fileName, String downloadUrl) {
-            this.label = label;
-            this.fileName = fileName;
-            this.downloadUrl = downloadUrl;
-        }
-    }
+    private static final String TURNIP_RELEASES_API =
+            "https://api.github.com/repos/StevenMXZ/freedreno_turnip-CI/releases?per_page=30";
+    private static final String TURNIP_RELEASES_CACHE_FILE = "turnip_releases_cache.json";
+    private static final long TURNIP_RELEASES_CACHE_TTL_MS = 15L * 60L * 1000L;
 
     private AdrenotoolsManager adrenotoolsManager;
     private RecyclerView recyclerView;
-    
-    @Override 
+
+    @Override
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-        this.adrenotoolsManager = new AdrenotoolsManager(getActivity());
+        adrenotoolsManager = new AdrenotoolsManager(getActivity());
     }
-    
+
     @Override
     public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
-        ViewGroup layout = (ViewGroup)inflater.inflate(R.layout.adrenotools_fragment, container, false);
+        ViewGroup layout = (ViewGroup) inflater.inflate(R.layout.adrenotools_fragment, container, false);
         recyclerView = layout.findViewById(R.id.RecyclerView);
         recyclerView.setLayoutManager(new LinearLayoutManager(recyclerView.getContext()));
         recyclerView.addItemDecoration(new DividerItemDecoration(recyclerView.getContext(), DividerItemDecoration.VERTICAL));
         recyclerView.setAdapter(new DriversAdapter(adrenotoolsManager.enumarateInstalledDrivers()));
+
         View btInstallDriver = layout.findViewById(R.id.BTInstallDriver);
-        btInstallDriver.setOnClickListener((v) -> {
+        btInstallDriver.setOnClickListener(v -> {
             ContentDialog.confirm(getContext(), getString(R.string.install_drivers_message) + " " + getString(R.string.install_drivers_warning), () -> {
                 Intent intent = new Intent(Intent.ACTION_OPEN_DOCUMENT);
                 intent.addCategory(Intent.CATEGORY_OPENABLE);
                 intent.setType("*/*");
-                getActivity().startActivityFromFragment(this, intent, MainActivity.OPEN_FILE_REQUEST_CODE);               
+                getActivity().startActivityFromFragment(this, intent, MainActivity.OPEN_FILE_REQUEST_CODE);
             });
         });
 
-        View btFetchLatest = layout.findViewById(R.id.BTFetchLatestDriver);
-        btFetchLatest.setOnClickListener(v -> fetchLatestDriver());
+        View btFetchLatestDriver = layout.findViewById(R.id.BTFetchLatestDriver);
+        btFetchLatestDriver.setOnClickListener(v -> openTurnipVersionPicker(false));
         return layout;
     }
-    
+
     @Override
     public void onViewCreated(View view, Bundle savedInstanceState) {
         super.onViewCreated(view, savedInstanceState);
         ((AppCompatActivity) getActivity()).getSupportActionBar().setTitle(R.string.adrenotools_gpu_drivers);
     }
-    
+
     @Override
     public void onActivityResult(int requestCode, int resultCode, Intent data) {
         if (requestCode == MainActivity.OPEN_FILE_REQUEST_CODE && resultCode == Activity.RESULT_OK) {
             Uri uri = data.getData();
             String driver = adrenotoolsManager.installDriver(uri);
-            if (!driver.isEmpty())
-                ((DriversAdapter)recyclerView.getAdapter()).addItem(driver);
+            if (!driver.isEmpty()) {
+                DriversAdapter adapter = (DriversAdapter) recyclerView.getAdapter();
+                if (adapter != null) adapter.addItem(driver);
+            }
         }
-     }       
+    }
+
+    private void openTurnipVersionPicker(boolean forceRefresh) {
+        if (!isAdded() || getActivity() == null) return;
+        DownloadProgressDialog progressDialog = new DownloadProgressDialog(getActivity());
+        progressDialog.show(R.string.loading_turnip_versions);
 
-    private void fetchLatestDriver() {
-        AppUtils.showToast(getContext(), R.string.turnip_loading_releases);
         new Thread(() -> {
             try {
-                String json = Downloader.downloadString(TURNIP_RELEASES_API);
-                if (json == null) throw new Exception("api null");
-                JSONArray releases = new JSONArray(json);
-                ArrayList<TurnipAsset> assetsToShow = new ArrayList<>();
-                for (int i = 0; i < releases.length(); i++) {
-                    JSONObject release = releases.getJSONObject(i);
-                    JSONArray assets = release.optJSONArray("assets");
-                    if (assets == null) continue;
-
-                    String releaseTitle = release.optString("name", release.optString("tag_name", "release"));
-                    for (int j = 0; j < assets.length(); j++) {
-                        JSONObject asset = assets.getJSONObject(j);
-                        String assetName = asset.optString("name", "");
-                        String assetUrl = asset.optString("browser_download_url", "");
-                        if (!assetName.toLowerCase().endsWith(".zip") || assetUrl.isEmpty()) continue;
-
-                        String label = releaseTitle + " / " + assetName;
-                        assetsToShow.add(new TurnipAsset(label, assetName, assetUrl));
+                ArrayList<TurnipAssetItem> items = loadTurnipAssetItems(forceRefresh);
+                if (!isAdded() || getActivity() == null) return;
+                getActivity().runOnUiThread(() -> {
+                    progressDialog.close();
+                    if (items.isEmpty()) {
+                        AppUtils.showToast(getContext(), R.string.no_items_to_display);
+                        return;
                     }
-                }
-                if (assetsToShow.isEmpty()) throw new Exception("no zip asset");
-                if (!isAdded()) return;
-
-                requireActivity().runOnUiThread(() -> {
-                    if (!isAdded()) return;
-                    String[] labels = new String[assetsToShow.size()];
-                    for (int i = 0; i < assetsToShow.size(); i++) labels[i] = assetsToShow.get(i).label;
-
-                    new android.app.AlertDialog.Builder(requireContext())
-                        .setTitle(R.string.fetch_latest_turnip)
-                        .setItems(labels, (dialog, which) -> {
-                            TurnipAsset selected = assetsToShow.get(which);
-                            downloadAndInstall(selected.downloadUrl, selected.fileName);
-                        })
-                        .setNegativeButton(android.R.string.cancel, null)
-                        .show();
+
+                    String[] labels = new String[items.size()];
+                    for (int i = 0; i < items.size(); i++) labels[i] = items.get(i).label;
+
+                    AlertDialog.Builder builder = new AlertDialog.Builder(getContext())
+                            .setTitle(R.string.turnip_choose_version)
+                            .setItems(labels, (dialog, which) -> downloadAndInstall(items.get(which)))
+                            .setNegativeButton(android.R.string.cancel, null);
+                    builder.setNeutralButton(R.string.refresh, (dialog, which) -> openTurnipVersionPicker(true));
+                    builder.show();
                 });
             } catch (Exception e) {
-                if (!isAdded()) return;
-                requireActivity().runOnUiThread(() -> AppUtils.showToast(getContext(), R.string.unable_to_install_content));
+                if (!isAdded() || getActivity() == null) return;
+                getActivity().runOnUiThread(() -> {
+                    progressDialog.close();
+                    AppUtils.showToast(getContext(), R.string.unable_to_fetch_turnip_versions);
+                });
             }
         }).start();
     }
 
-    private void downloadAndInstall(String url, String fileName) {
-        AppUtils.showToast(getContext(), R.string.downloading_file);
+    private ArrayList<TurnipAssetItem> loadTurnipAssetItems(boolean forceRefresh) throws Exception {
+        String json = null;
+        File cacheFile = new File(requireContext().getCacheDir(), TURNIP_RELEASES_CACHE_FILE);
+
+        if (!forceRefresh && cacheFile.isFile()) {
+            long age = System.currentTimeMillis() - cacheFile.lastModified();
+            if (age >= 0 && age <= TURNIP_RELEASES_CACHE_TTL_MS) {
+                json = FileUtils.readString(cacheFile);
+            }
+        }
+
+        if (json == null || json.trim().isEmpty()) {
+            json = Downloader.downloadString(TURNIP_RELEASES_API);
+            if (json == null || json.trim().isEmpty()) throw new IllegalStateException("empty turnip releases response");
+            FileUtils.writeString(cacheFile, json);
+        }
+
+        JSONArray releases = new JSONArray(json);
+        ArrayList<TurnipAssetItem> items = new ArrayList<>();
+        for (int i = 0; i < releases.length(); i++) {
+            JSONObject release = releases.getJSONObject(i);
+            String releaseName = release.optString("name", release.optString("tag_name", "release"));
+            String tagName = release.optString("tag_name", "");
+            String publishedAt = release.optString("published_at", "");
+            boolean prerelease = release.optBoolean("prerelease", false);
+            JSONArray assets = release.optJSONArray("assets");
+            if (assets == null) continue;
+
+            for (int j = 0; j < assets.length(); j++) {
+                JSONObject asset = assets.getJSONObject(j);
+                String assetName = asset.optString("name", "");
+                String url = asset.optString("browser_download_url", "");
+                if (assetName.isEmpty() || url.isEmpty()) continue;
+                if (!assetName.toLowerCase().endsWith(".zip")) continue;
+
+                TurnipAssetItem item = new TurnipAssetItem();
+                item.releaseName = releaseName;
+                item.tagName = tagName;
+                item.assetName = assetName;
+                item.downloadUrl = url;
+                item.publishedAt = publishedAt;
+                item.prerelease = prerelease;
+                item.label = buildTurnipLabel(item, i == 0);
+                items.add(item);
+            }
+        }
+        return items;
+    }
+
+    private String buildTurnipLabel(TurnipAssetItem item, boolean firstReleaseInList) {
+        String channel;
+        if (firstReleaseInList) channel = getString(R.string.turnip_channel_latest);
+        else if (item.prerelease) channel = getString(R.string.channel_beta);
+        else channel = getString(R.string.channel_stable);
+
+        String date = item.publishedAt;
+        if (date != null && date.length() >= 10) {
+            date = date.substring(0, 10);
+        } else {
+            date = DateFormat.format("yyyy-MM-dd", new Date()).toString();
+        }
+
+        String releaseLabel = !item.releaseName.isEmpty() ? item.releaseName : item.tagName;
+        return channel + " • " + date + " • " + releaseLabel + "\n" + item.assetName;
+    }
+
+    private void downloadAndInstall(TurnipAssetItem item) {
+        if (!isAdded() || getActivity() == null) return;
+
+        DownloadProgressDialog progressDialog = new DownloadProgressDialog(getActivity());
+        progressDialog.show(R.string.downloading_file);
+
         new Thread(() -> {
+            File out = null;
             try {
-                if (!isAdded()) return;
-                File cacheDir = requireContext().getCacheDir();
-                String safeName = fileName.replaceAll("[^A-Za-z0-9._-]", "_");
-                File out = new File(cacheDir, "turnip-" + System.currentTimeMillis() + "-" + safeName);
-                if (!Downloader.downloadFile(url, out)) throw new Exception("download failed");
-                String driver = adrenotoolsManager.installDriver(Uri.fromFile(out));
-                if (!isAdded()) return;
-                requireActivity().runOnUiThread(() -> {
-                    if (!driver.isEmpty()) {
-                        ((DriversAdapter)recyclerView.getAdapter()).addItem(driver);
+                if (!isAdded() || getContext() == null) return;
+                out = new File(getContext().getCacheDir(),
+                        "turnip_" + System.currentTimeMillis() + "_" + sanitizeFilename(item.assetName));
+                downloadFileWithProgress(item.downloadUrl, out, progress -> {
+                    if (!isAdded() || getActivity() == null) return;
+                    getActivity().runOnUiThread(() -> progressDialog.setProgress(progress));
+                });
+
+                String driver = adrenotoolsManager.installDriver(out);
+                if (!isAdded() || getActivity() == null) return;
+                String installedDriver = driver;
+                getActivity().runOnUiThread(() -> {
+                    progressDialog.close();
+                    if (!installedDriver.isEmpty()) {
+                        DriversAdapter adapter = (DriversAdapter) recyclerView.getAdapter();
+                        if (adapter != null) adapter.addItem(installedDriver);
                         AppUtils.showToast(getContext(), R.string.content_installed_success);
                     } else {
-                        AppUtils.showToast(getContext(), R.string.unable_to_install_content);
+                        AppUtils.showToast(getContext(), R.string.turnip_install_failed_or_exists);
                     }
                 });
             } catch (Exception e) {
-                if (!isAdded()) return;
-                requireActivity().runOnUiThread(() -> AppUtils.showToast(getContext(), R.string.unable_to_install_content));
+                if (!isAdded() || getActivity() == null) return;
+                getActivity().runOnUiThread(() -> {
+                    progressDialog.close();
+                    AppUtils.showToast(getContext(), R.string.turnip_download_failed);
+                });
+            } finally {
+                if (out != null && out.exists()) {
+                    // Keep cache clean; installed payload is copied by AdrenotoolsManager.
+                    //noinspection ResultOfMethodCallIgnored
+                    out.delete();
+                }
             }
         }).start();
     }
-    
+
+    private void downloadFileWithProgress(String address, File file, ProgressCallback progressCallback) throws Exception {
+        URLConnection connection = new URL(address).openConnection();
+        connection.connect();
+        int contentLength = connection.getContentLength();
+
+        try (InputStream input = new BufferedInputStream(connection.getInputStream());
+             OutputStream output = new FileOutputStream(file)) {
+            byte[] data = new byte[8192];
+            long total = 0;
+            int count;
+            int lastProgress = -1;
+            while ((count = input.read(data)) != -1) {
+                output.write(data, 0, count);
+                total += count;
+                if (contentLength > 0) {
+                    int progress = (int) ((total * 100L) / contentLength);
+                    if (progress != lastProgress) {
+                        lastProgress = progress;
+                        progressCallback.onProgress(progress);
+                    }
+                }
+            }
+            progressCallback.onProgress(100);
+            output.flush();
+        }
+    }
+
+    private String sanitizeFilename(String name) {
+        if (name == null || name.isEmpty()) return "driver.zip";
+        return name.replaceAll("[^a-zA-Z0-9._-]", "_");
+    }
+
+    private interface ProgressCallback {
+        void onProgress(int progress);
+    }
+
+    private static class TurnipAssetItem {
+        String releaseName;
+        String tagName;
+        String assetName;
+        String downloadUrl;
+        String publishedAt;
+        boolean prerelease;
+        String label;
+    }
+
     private class DriversAdapter extends RecyclerView.Adapter<DriversAdapter.ViewHolder> {
-        private ArrayList<String> driversList;
+        private final ArrayList<String> driversList;
 
         public class ViewHolder extends RecyclerView.ViewHolder {
-            private TextView tvName;
-            private TextView tvVersion;
-            private ImageButton btMenu;
+            private final TextView tvName;
+            private final TextView tvVersion;
+            private final ImageButton btMenu;
 
             public ViewHolder(View v) {
                 super(v);
@@ -177,38 +304,37 @@ public class AdrenotoolsFragment extends Fragment {
                 btMenu = v.findViewById(R.id.BTMenu);
             }
         }
-        
+
         public DriversAdapter(ArrayList<String> driversList) {
             this.driversList = driversList;
         }
-        
+
         @Override
         public ViewHolder onCreateViewHolder(ViewGroup viewGroup, int viewType) {
             View view = LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.adrenotools_list_item, viewGroup, false);
             return new ViewHolder(view);
         }
-        
+
         @Override
         public void onBindViewHolder(ViewHolder viewHolder, final int position) {
             viewHolder.tvName.setText(adrenotoolsManager.getDriverName(driversList.get(position)));
             viewHolder.tvVersion.setText(adrenotoolsManager.getDriverVersion(driversList.get(position)));
-            viewHolder.btMenu.setOnClickListener((v) -> {
-                removeAtIndex(position);
-            });
+            viewHolder.btMenu.setOnClickListener(v -> removeAtIndex(position));
         }
-        
+
         public void addItem(String item) {
+            if (driversList.contains(item)) return;
             driversList.add(item);
             notifyItemInserted(getItemCount() - 1);
         }
-        
+
         public void removeAtIndex(int index) {
             String deletedDriver = driversList.remove(index);
             adrenotoolsManager.removeDriver(deletedDriver);
             notifyItemRemoved(index);
             notifyItemRangeChanged(index, getItemCount());
         }
-        
+
         @Override
         public int getItemCount() {
             return driversList.size();
diff --git a/app/src/main/java/com/winlator/cmod/ContentsFragment.java b/app/src/main/java/com/winlator/cmod/ContentsFragment.java
index 0d2842a..37beb41 100644
--- a/app/src/main/java/com/winlator/cmod/ContentsFragment.java
+++ b/app/src/main/java/com/winlator/cmod/ContentsFragment.java
@@ -1,5 +1,5 @@
 package com.winlator.cmod;
-
+
 import android.annotation.SuppressLint;
 import android.app.Activity;
 import android.content.Intent;
@@ -12,12 +12,13 @@ import android.view.View;
 import android.view.ViewGroup;
 import android.widget.AdapterView;
 import android.widget.ArrayAdapter;
-import android.widget.ImageButton;
-import android.widget.ImageView;
-import android.widget.PopupMenu;
-import android.widget.ProgressBar;
-import android.widget.Spinner;
-import android.widget.TextView;
+import android.widget.ImageButton;
+import android.widget.ImageView;
+import android.widget.PopupMenu;
+import android.widget.ProgressBar;
+import android.widget.Spinner;
+import android.widget.Switch;
+import android.widget.TextView;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
@@ -42,8 +43,9 @@ import com.winlator.cmod.core.FileUtils;
 import com.winlator.cmod.core.PreloaderDialog;
 
 import java.io.File;
-import java.util.ArrayList;
-import java.util.List;
+import java.util.ArrayList;
+import java.util.List;
+import java.util.Locale;
 import java.util.concurrent.Executors;
 
 public class ContentsFragment extends Fragment {
@@ -51,14 +53,13 @@ public class ContentsFragment extends Fragment {
     private View emptyText;
     private ContentsManager manager;
     SharedPreferences sp;
-    private ContentProfile.ContentType currentContentType = ContentProfile.ContentType.CONTENT_TYPE_WINE;
+    private ContentProfile.ContentType currentContentType = ContentProfile.ContentType.CONTENT_TYPE_WINE;
     private Spinner sContentType;
+    private Switch swShowBeta;
+    private boolean showBeta;
+    private final List<ContentProfile.ContentType> allowedTypes = new ArrayList<>();
 
-    private android.widget.Switch swShowBeta;
-    private boolean showBeta = false;
-    private List<ContentProfile.ContentType> allowedTypes = new ArrayList<>();
-
-    private boolean isDarkMode;
+    private boolean isDarkMode;
 
     @Override
     public void onCreate(@Nullable Bundle savedInstanceState) {
@@ -68,11 +69,15 @@ public class ContentsFragment extends Fragment {
         manager.syncContents();
         sp = PreferenceManager.getDefaultSharedPreferences(getActivity());
         showBeta = sp.getBoolean("beta_contents_enabled", false);
+        initAllowedTypes();
+        if (!allowedTypes.isEmpty()) {
+            currentContentType = allowedTypes.get(0);
+        }
 
         // Initialize isDarkMode based on shared preferences or theme
         isDarkMode = PreferenceManager.getDefaultSharedPreferences(getContext())
                 .getBoolean("dark_mode", false);
-    }
+    }
 
     @Override
     public void onDestroy() {
@@ -80,25 +85,11 @@ public class ContentsFragment extends Fragment {
         super.onDestroy();
     }
 
-    @Override
+    @Override
     public void onResume() {
         super.onResume();
-        refreshContentUi();
         reloadRemoteContents();
     }
-
-    private void reloadRemoteContents() {
-        new Thread(() -> {
-            String contentsURL = sp.getString("downloadable_contents_url", ContentsManager.REMOTE_PROFILES);
-            String json = Downloader.downloadString(contentsURL);
-            if (json == null || !isAdded())
-                return;
-            requireActivity().runOnUiThread(() -> {
-                manager.setRemoteProfiles(json, showBeta, false);
-                refreshContentUi();
-            });
-        }).start();
-    }
 
     @Override
     public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
@@ -108,18 +99,13 @@ public class ContentsFragment extends Fragment {
 
     @Nullable
     @Override
-    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
+    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
         ViewGroup layout = (ViewGroup) inflater.inflate(R.layout.contents_fragment, container, false);
 
-        emptyText = layout.findViewById(R.id.TVEmptyText);
-
-        recyclerView = layout.findViewById(R.id.RecyclerView);
-        recyclerView.setLayoutManager(new LinearLayoutManager(recyclerView.getContext()));
-        recyclerView.addItemDecoration(new DividerItemDecoration(recyclerView.getContext(), DividerItemDecoration.VERTICAL));
-
         sContentType = layout.findViewById(R.id.SContentType);
-        refreshContentUi();
+        updateContentTypeSpinner(sContentType);
 
+        emptyText = layout.findViewById(R.id.TVEmptyText);
         swShowBeta = layout.findViewById(R.id.SwShowBeta);
         swShowBeta.setChecked(showBeta);
         swShowBeta.setOnCheckedChangeListener((buttonView, isChecked) -> {
@@ -135,70 +121,120 @@ public class ContentsFragment extends Fragment {
                 Intent intent = new Intent(Intent.ACTION_OPEN_DOCUMENT);
                 intent.addCategory(Intent.CATEGORY_OPENABLE);
                 intent.setType("*/*");
-                getActivity().startActivityFromFragment(this, intent, MainActivity.OPEN_FILE_REQUEST_CODE);
-            });
-        });
-
-        return layout;
-    }
-
+                getActivity().startActivityFromFragment(this, intent, MainActivity.OPEN_FILE_REQUEST_CODE);
+            });
+        });
+
+        recyclerView = layout.findViewById(R.id.RecyclerView);
+        recyclerView.setLayoutManager(new LinearLayoutManager(recyclerView.getContext()));
+        recyclerView.addItemDecoration(new DividerItemDecoration(recyclerView.getContext(), DividerItemDecoration.VERTICAL));
+        loadContentList();
+
+        return layout;
+    }
+
     private void updateContentTypeSpinner(Spinner spinner) {
         List<String> typeList = new ArrayList<>();
-        for (ContentProfile.ContentType type : allowedTypes) {
-            typeList.add(type.toString());
-        }
-        ArrayAdapter<String> adapter = new ArrayAdapter<>(getContext(), android.R.layout.simple_spinner_item, typeList);
-        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
-        spinner.setAdapter(adapter);
-
-        // Set the popup background based on the theme
-        spinner.setPopupBackgroundResource(isDarkMode ? R.drawable.content_dialog_background_dark : R.drawable.content_dialog_background);
-
+        for (ContentProfile.ContentType type : allowedTypes)
+            typeList.add(getDisplayTypeLabel(type));
+        spinner.setAdapter(new ArrayAdapter<>(getContext(), android.R.layout.simple_spinner_dropdown_item, typeList));
+
+        // Set the popup background based on the theme
+        spinner.setPopupBackgroundResource(isDarkMode ? R.drawable.content_dialog_background_dark : R.drawable.content_dialog_background);
+
         spinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
             @Override
             public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {
-                if (position < 0 || position >= allowedTypes.size()) return;
-                currentContentType = allowedTypes.get(position);
+                if (position >= 0 && position < allowedTypes.size())
+                    currentContentType = allowedTypes.get(position);
+                updateContentsListView();
                 loadContentList();
             }
 
             @Override
-                public void onNothingSelected(AdapterView<?> parent) {
-
-            }
-        });
-
-        int currentIndex = allowedTypes.indexOf(currentContentType);
-        if (currentIndex < 0) currentIndex = 0;
-        spinner.setSelection(currentIndex);
+            public void onNothingSelected(AdapterView<?> parent) {
+
+            }
+        });
     }
 
-    private void rebuildAllowedTypes() {
-        List<ContentProfile.ContentType> updatedAllowedTypes = new ArrayList<>();
+    private void initAllowedTypes() {
+        allowedTypes.clear();
         for (ContentProfile.ContentType type : ContentProfile.ContentType.values()) {
-            List<ContentProfile> profiles = manager.getProfiles(type);
-            if (profiles != null && !profiles.isEmpty()) {
-                updatedAllowedTypes.add(type);
-            }
+            if (type == ContentProfile.ContentType.CONTENT_TYPE_BOX64) continue;
+            if (type == ContentProfile.ContentType.CONTENT_TYPE_WOWBOX64) continue;
+            allowedTypes.add(type);
         }
+    }
 
-        if (updatedAllowedTypes.isEmpty()) {
-            updatedAllowedTypes.add(ContentProfile.ContentType.CONTENT_TYPE_WINE);
-        }
+    private void reloadRemoteContents() {
+        new Thread(() -> {
+            String contentsURL = sp.getString("downloadable_contents_url", ContentsManager.REMOTE_PROFILES);
+            String json = Downloader.downloadString(contentsURL);
+            if (json == null || !isAdded() || getActivity() == null)
+                return;
+            getActivity().runOnUiThread(() -> {
+                manager.setRemoteProfiles(json, showBeta, false);
+                loadContentList();
+            });
+        }).start();
+    }
 
-        allowedTypes = updatedAllowedTypes;
-        if (!allowedTypes.contains(currentContentType)) {
-            currentContentType = allowedTypes.get(0);
-        }
+    private String getDisplayTypeLabel(ContentProfile.ContentType type) {
+        if (type == ContentProfile.ContentType.CONTENT_TYPE_WINE) return getString(R.string.wine_proton);
+        return type.toString();
+    }
+
+    private String getDisplayCategory(ContentProfile profile) {
+        String display = profile.getDisplayCategory();
+        return (display == null || display.isEmpty()) ? getDisplayTypeLabel(profile.type) : display;
     }
 
-    private void refreshContentUi() {
-        rebuildAllowedTypes();
-        if (sContentType != null) {
-            updateContentTypeSpinner(sContentType);
+    private String getChannelLabel(ContentProfile profile) {
+        return switch (profile.getChannel()) {
+            case ContentProfile.CHANNEL_BETA -> getString(R.string.channel_beta);
+            case ContentProfile.CHANNEL_NIGHTLY -> getString(R.string.channel_nightly);
+            default -> getString(R.string.channel_stable);
+        };
+    }
+
+    private String getDeliveryLabel(ContentProfile profile) {
+        String delivery = profile.getDelivery();
+        if (ContentProfile.DELIVERY_EMBEDDED.equals(delivery)) return getString(R.string.package_source_embedded);
+        if (profile.isRemoteDownloadable()) return getString(R.string.package_source_online);
+        return getString(R.string.package_source_installed);
+    }
+
+    private String buildProfileTitleLine(ContentProfile profile) {
+        return getDisplayCategory(profile) + " • " + profile.verName;
+    }
+
+    private String buildProfileMetaLine(ContentProfile profile) {
+        return getString(R.string.version_code) + ": " + profile.verCode
+                + " • " + getChannelLabel(profile)
+                + " • " + getDeliveryLabel(profile);
+    }
+
+    private String buildProfileSourceLine(ContentProfile profile) {
+        if (profile.sourceRepo != null && !profile.sourceRepo.isEmpty()) {
+            String line = getString(R.string.package_source_repo_prefix) + " " + profile.sourceRepo;
+            if (profile.releaseTag != null && !profile.releaseTag.isEmpty()) line += " • " + profile.releaseTag;
+            if (profile.remoteUrl != null && profile.remoteUrl.toLowerCase(Locale.US).contains("/releases/download/")) {
+                line += " • " + getString(R.string.package_source_github_release);
+            }
+            return line;
         }
-        loadContentList();
+        if (profile.isRemoteDownloadable()) return getString(R.string.package_source_online_not_embedded);
+        return "";
     }
+
+    private void updateContentsListView() {
+        List<ContentProfile> profiles = manager.getProfiles(currentContentType);
+        if (profiles == null || profiles.isEmpty()) {
+            recyclerView.setVisibility(View.GONE);
+            emptyText.setVisibility(View.VISIBLE);
+        }
+    }
 
     @Override
     public void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {
@@ -249,12 +285,17 @@ public class ContentsFragment extends Fragment {
                             requireActivity().runOnUiThread(() -> {
                                 ContentDialog.alert(getContext(), R.string.content_installed_success, null);
                                 manager.syncContents();
-                                currentContentType = profile.type;
-                                refreshContentUi();
+                                boolean flashAfter = currentContentType == profile.type;
+                                if (allowedTypes.contains(profile.type)) {
+                                    currentContentType = profile.type;
+                                    int index = allowedTypes.indexOf(currentContentType);
+                                    if (index >= 0) sContentType.setSelection(index);
+                                }
+                                if (flashAfter) loadContentList();
                             });
                         }
-                    }
-                };
+                    }
+                };
                 Executors.newSingleThreadExecutor().execute(() -> {
                     manager.extraContentFile(data.getData(), callback);
                 });
@@ -266,13 +307,11 @@ public class ContentsFragment extends Fragment {
     }
 
     private void loadContentList() {
-        if (recyclerView == null || emptyText == null) return;
         List<ContentProfile> profiles = manager.getProfiles(currentContentType);
-        if (profiles == null) profiles = new ArrayList<>();
-        if (profiles.isEmpty()) {
+        if (profiles == null || profiles.isEmpty()) {
             emptyText.setVisibility(View.VISIBLE);
             recyclerView.setVisibility(View.GONE);
-        } else {
+        } else {
             emptyText.setVisibility(View.GONE);
             recyclerView.setVisibility(View.VISIBLE);
             recyclerView.setAdapter(new ContentItemAdapter(profiles));
@@ -282,25 +321,27 @@ public class ContentsFragment extends Fragment {
     private class ContentItemAdapter extends RecyclerView.Adapter<ContentItemAdapter.ViewHolder> {
         private final List<ContentProfile> data;
 
-        private static class ViewHolder extends RecyclerView.ViewHolder {
-            private final ImageView ivIcon;
-            private final TextView tvVersionName;
-            private final TextView tvVersionCode;
-            private final ImageButton ibMenu;
-            private final ImageButton ibDownload;
-            private final ProgressBar progressBar;
+        private static class ViewHolder extends RecyclerView.ViewHolder {
+            private final ImageView ivIcon;
+            private final TextView tvVersionName;
+            private final TextView tvVersionCode;
+            private final TextView tvSource;
+            private final ImageButton ibMenu;
+            private final ImageButton ibDownload;
+            private final ProgressBar progressBar;
 
             public ViewHolder(@NonNull View view) {
                 super(view);
 
-                ivIcon = view.findViewById(R.id.IVIcon);
-                tvVersionName = view.findViewById(R.id.TVVersionName);
-                tvVersionCode = view.findViewById(R.id.TVVersionCode);
-                ibMenu = view.findViewById(R.id.BTMenu);
-                ibDownload = view.findViewById(R.id.BTDownload);
-                progressBar = view.findViewById(R.id.Progress);
-            }
-        }
+                ivIcon = view.findViewById(R.id.IVIcon);
+                tvVersionName = view.findViewById(R.id.TVVersionName);
+                tvVersionCode = view.findViewById(R.id.TVVersionCode);
+                tvSource = view.findViewById(R.id.TVSource);
+                ibMenu = view.findViewById(R.id.BTMenu);
+                ibDownload = view.findViewById(R.id.BTDownload);
+                progressBar = view.findViewById(R.id.Progress);
+            }
+        }
 
         public ContentItemAdapter(List<ContentProfile> data) {
             this.data = data;
@@ -329,9 +370,12 @@ public class ContentsFragment extends Fragment {
             };
             holder.ivIcon.setBackground(getContext().getDrawable(iconId));
 
-            holder.tvVersionName.setText(getContext().getString(R.string.version) + ": " + profile.verName);
-            holder.tvVersionCode.setText(getContext().getString(R.string.version_code) + ": " + profile.verCode);
-            holder.ibMenu.setVisibility(profile.remoteUrl == null ? View.VISIBLE : View.GONE);
+            holder.tvVersionName.setText(buildProfileTitleLine(profile));
+            holder.tvVersionCode.setText(buildProfileMetaLine(profile));
+            String sourceLine = buildProfileSourceLine(profile);
+            holder.tvSource.setText(sourceLine);
+            holder.tvSource.setVisibility(sourceLine.isEmpty() ? View.GONE : View.VISIBLE);
+            holder.ibMenu.setVisibility(profile.isRemoteDownloadable() ? View.GONE : View.VISIBLE);
             holder.ibMenu.setOnClickListener(v -> {
                 PopupMenu selectionMenu = new PopupMenu(getContext(), holder.ibMenu);
                 if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q)
@@ -360,34 +404,31 @@ public class ContentsFragment extends Fragment {
                 });
                 selectionMenu.show();
             });
-            holder.ibDownload.setVisibility((profile.remoteUrl != null) && (holder.progressBar.getVisibility() == View.GONE) ? View.VISIBLE : View.GONE);
-            holder.ibDownload.setOnClickListener(v -> {
-                holder.ibDownload.setVisibility(View.GONE);
-                holder.progressBar.setVisibility(View.VISIBLE);
-
+            holder.ibDownload.setVisibility(profile.isRemoteDownloadable() && (holder.progressBar.getVisibility() == View.GONE) ? View.VISIBLE : View.GONE);
+            holder.ibDownload.setOnClickListener(v -> {
+                holder.ibDownload.setVisibility(View.GONE);
+                holder.progressBar.setVisibility(View.VISIBLE);
+
+                Intent intent = new Intent();
+                intent.setData(Uri.parse(profile.remoteUrl));
                 new Thread(() -> {
                     long timestamp = System.currentTimeMillis();
-                    File output = new File(getContext().getCacheDir(), "temp_" + timestamp);
-                    boolean downloaded = Downloader.downloadFile(profile.remoteUrl, output);
-                    if (!isAdded()) return;
-                    requireActivity().runOnUiThread(() -> {
-                        holder.progressBar.setVisibility(View.GONE);
-                        holder.ibDownload.setVisibility(View.VISIBLE);
-                        if (!downloaded) {
-                            AppUtils.showToast(getContext(), R.string.unable_to_install_content);
-                            return;
-                        }
-                        Intent intent = new Intent();
-                        intent.setData(Uri.fromFile(output));
-                        onActivityResult(MainActivity.OPEN_FILE_REQUEST_CODE, Activity.RESULT_OK, intent);
-                    });
-                }).start();
-            });
-        }
-
-        @Override
-        public int getItemCount() {
-            return data.size();
-        }
-    }
-}
+                    File output = new File(getContext().getCacheDir(), "content_" + timestamp + ".wcp");
+                    if (Downloader.downloadFile(profile.remoteUrl, output)) {
+                        intent.setData(Uri.parse(output.getAbsolutePath()));
+                    }
+                    getActivity().runOnUiThread(() -> {
+                        holder.progressBar.setVisibility(View.GONE);
+                        holder.ibDownload.setVisibility(View.VISIBLE);
+                        onActivityResult(MainActivity.OPEN_FILE_REQUEST_CODE, Activity.RESULT_OK, intent);
+                    });
+                }).start();
+            });
+        }
+
+        @Override
+        public int getItemCount() {
+            return data.size();
+        }
+    }
+}
diff --git a/app/src/main/java/com/winlator/cmod/SettingsFragment.java b/app/src/main/java/com/winlator/cmod/SettingsFragment.java
index b7261a6..5b8240f 100644
--- a/app/src/main/java/com/winlator/cmod/SettingsFragment.java
+++ b/app/src/main/java/com/winlator/cmod/SettingsFragment.java
@@ -269,8 +269,14 @@ public class SettingsFragment extends Fragment {
         final ArrayList<String> wineDebugChannels = new ArrayList<>(Arrays.asList(preferences.getString("wine_debug_channels", DEFAULT_WINE_DEBUG_CHANNELS).split(",")));
         loadWineDebugChannels(view, wineDebugChannels);
 
-        final CheckBox cbEnableBox64Logs = view.findViewById(R.id.CBEnableBox64Logs);
-        cbEnableBox64Logs.setChecked(preferences.getBoolean("enable_box64_logs", false));
+        final CheckBox cbEnableBox64Logs = view.findViewById(R.id.CBEnableBox64Logs);
+        cbEnableBox64Logs.setChecked(preferences.getBoolean("enable_box64_logs", false));
+        final CheckBox cbEnableFEXLogs = view.findViewById(R.id.CBEnableFEXLogs);
+        cbEnableFEXLogs.setChecked(preferences.getBoolean("enable_fex_logs", false));
+        final CheckBox cbEnableVulkanLogs = view.findViewById(R.id.CBEnableVulkanLogs);
+        cbEnableVulkanLogs.setChecked(preferences.getBoolean("enable_vulkan_api_dump", false));
+        final CheckBox cbEnableTurnipLogs = view.findViewById(R.id.CBEnableTurnipLogs);
+        cbEnableTurnipLogs.setChecked(preferences.getBoolean("enable_turnip_logs", false));
 
         final TextView tvCursorSpeed = view.findViewById(R.id.TVCursorSpeed);
         final SeekBar sbCursorSpeed = view.findViewById(R.id.SBCursorSpeed);
@@ -317,10 +323,13 @@ public class SettingsFragment extends Fragment {
             editor.putString("fexcore_preset", FEXCorePresetManager.getSpinnerSelectedId(sFEXCorePreset));
             editor.putBoolean("use_dri3", cbUseDRI3.isChecked());
             editor.putBoolean("use_xr", cbUseXR.isChecked());
-            editor.putFloat("cursor_speed", sbCursorSpeed.getProgress() / 100.0f);
-            editor.putBoolean("enable_wine_debug", cbEnableWineDebug.isChecked());
-            editor.putBoolean("enable_box64_logs", cbEnableBox64Logs.isChecked());
-            editor.putBoolean("cursor_lock", cbCursorLock.isChecked()); // Save cursor lock state
+            editor.putFloat("cursor_speed", sbCursorSpeed.getProgress() / 100.0f);
+            editor.putBoolean("enable_wine_debug", cbEnableWineDebug.isChecked());
+            editor.putBoolean("enable_box64_logs", cbEnableBox64Logs.isChecked());
+            editor.putBoolean("enable_fex_logs", cbEnableFEXLogs.isChecked());
+            editor.putBoolean("enable_vulkan_api_dump", cbEnableVulkanLogs.isChecked());
+            editor.putBoolean("enable_turnip_logs", cbEnableTurnipLogs.isChecked());
+            editor.putBoolean("cursor_lock", cbCursorLock.isChecked()); // Save cursor lock state
             editor.putBoolean("xinput_toggle", cbXinputToggle.isChecked()); // Save xinput toggle state
             editor.putBoolean("enable_file_provider", cbEnableFileProvider.isChecked());
             editor.putBoolean("open_with_android_browser", cbOpenInBrowser.isChecked());
diff --git a/app/src/main/java/com/winlator/cmod/XServerDisplayActivity.java b/app/src/main/java/com/winlator/cmod/XServerDisplayActivity.java
index a58c735..b7bbcbe 100644
--- a/app/src/main/java/com/winlator/cmod/XServerDisplayActivity.java
+++ b/app/src/main/java/com/winlator/cmod/XServerDisplayActivity.java
@@ -48,10 +48,12 @@ import androidx.core.view.GravityCompat;
 import androidx.drawerlayout.widget.DrawerLayout;
 import androidx.preference.PreferenceManager;
 
-import com.google.android.material.navigation.NavigationView;
-import com.winlator.cmod.container.Container;
-import com.winlator.cmod.container.ContainerManager;
-import com.winlator.cmod.container.Shortcut;
+import com.google.android.material.navigation.NavigationView;
+import com.winlator.cmod.container.Container;
+import com.winlator.cmod.container.ContainerForensicSnapshot;
+import com.winlator.cmod.container.ContainerManager;
+import com.winlator.cmod.container.ContainerNormalizer;
+import com.winlator.cmod.container.Shortcut;
 import com.winlator.cmod.contentdialog.ContentDialog;
 import com.winlator.cmod.contentdialog.DXVKConfigDialog;
 import com.winlator.cmod.contentdialog.DebugDialog;
@@ -62,17 +64,20 @@ import com.winlator.cmod.contents.ContentProfile;
 import com.winlator.cmod.contents.ContentsManager;
 import com.winlator.cmod.contents.AdrenotoolsManager;
 import com.winlator.cmod.core.AppUtils;
-import com.winlator.cmod.core.DefaultVersion;
-import com.winlator.cmod.core.EnvVars;
-import com.winlator.cmod.core.FileUtils;
-import com.winlator.cmod.core.GPUInformation;
-import com.winlator.cmod.core.KeyValueSet;
+import com.winlator.cmod.core.DefaultVersion;
+import com.winlator.cmod.core.EnvVars;
+import com.winlator.cmod.core.FileDebugLogger;
+import com.winlator.cmod.core.FileUtils;
+import com.winlator.cmod.core.ForensicLogger;
+import com.winlator.cmod.core.GPUInformation;
+import com.winlator.cmod.core.KeyValueSet;
 import com.winlator.cmod.core.OnExtractFileListener;
 import com.winlator.cmod.core.PreloaderDialog;
 import com.winlator.cmod.core.ProcessHelper;
 import com.winlator.cmod.core.StringUtils;
-import com.winlator.cmod.core.TarCompressorUtils;
-import com.winlator.cmod.core.WineInfo;
+import com.winlator.cmod.core.TarCompressorUtils;
+import com.winlator.cmod.core.WinlatorLogUtils;
+import com.winlator.cmod.core.WineInfo;
 import com.winlator.cmod.core.WineRegistryEditor;
 import com.winlator.cmod.core.WineRequestHandler;
 import com.winlator.cmod.core.WineStartMenuCreator;
@@ -189,13 +194,18 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
 
     // Playtime stats tracking
     private long startTime;
-    private SharedPreferences playtimePrefs;
-    private String shortcutName;
-    private Handler handler;
-    private Runnable savePlaytimeRunnable;
-    private static final long SAVE_INTERVAL_MS = 1000;
-
-    private Handler  timeoutHandler = new Handler(Looper.getMainLooper());
+    private SharedPreferences playtimePrefs;
+    private String shortcutName;
+    private Handler handler;
+    private Runnable savePlaytimeRunnable;
+    private static final long SAVE_INTERVAL_MS = 1000;
+    private String forensicTraceId;
+    private String forensicRouteSource = "";
+    private boolean forensicMode = false;
+    private boolean forensicSkipPlaytime = false;
+    private ContainerNormalizer.NormalizationResult runtimeNormalization;
+
+    private Handler  timeoutHandler = new Handler(Looper.getMainLooper());
     private Runnable hideControlsRunnable;
 
     private boolean isDarkMode;
@@ -242,39 +252,19 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
         }
     };
 
-    private float pickHighestRefreshRate() {
-    	android.view.Display display = getWindowManager().getDefaultDisplay();
-    	android.view.Display.Mode[] modes = display.getSupportedModes();
-    	
-    	float maxRefresh = 0f;
-    	
-    	for (android.view.Display.Mode mode : modes) {
-			if (mode.getRefreshRate() > maxRefresh)
-    	    	maxRefresh = mode.getRefreshRate();
-    	}
-
-    	Log.d("XServerDisplayActivity", "Picking refresh rate " + maxRefresh);
-
-    	return maxRefresh;
-    }
-
 
     @Override
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         AppUtils.hideSystemUI(this);
         AppUtils.keepScreenOn(this);
-
-        android.view.WindowManager.LayoutParams params = getWindow().getAttributes();
-        params.preferredRefreshRate = pickHighestRefreshRate();
-        getWindow().setAttributes(params);
-        
         setContentView(R.layout.xserver_display_activity);
 
-        preloaderDialog = new PreloaderDialog(this);
-        preferences = PreferenceManager.getDefaultSharedPreferences(this);
-
-        cursorLock = preferences.getBoolean("cursor_lock", false);
+        preloaderDialog = new PreloaderDialog(this);
+        preferences = PreferenceManager.getDefaultSharedPreferences(this);
+        initForensicIntentState(getIntent());
+
+        cursorLock = preferences.getBoolean("cursor_lock", false);
 
         // Check for Dark Mode
         isDarkMode = preferences.getBoolean("dark_mode", false);
@@ -321,14 +311,16 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
 
         // Initialize handler for periodic saving
         handler = new Handler(Looper.getMainLooper());
-        savePlaytimeRunnable = new Runnable() {
-            @Override
-            public void run() {
-                savePlaytimeData();
-                handler.postDelayed(this, SAVE_INTERVAL_MS);
-            }
-        };
-        handler.postDelayed(savePlaytimeRunnable, SAVE_INTERVAL_MS);
+        savePlaytimeRunnable = new Runnable() {
+            @Override
+            public void run() {
+                savePlaytimeData();
+                handler.postDelayed(this, SAVE_INTERVAL_MS);
+            }
+        };
+        if (!forensicSkipPlaytime) {
+            handler.postDelayed(savePlaytimeRunnable, SAVE_INTERVAL_MS);
+        }
 
 
         // Handler and Runnable to manage timeout for hiding controls
@@ -357,7 +349,11 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
             navigationView.setBackgroundResource(R.color.content_dialog_background_dark);
         }
 
-        boolean enableLogs = preferences.getBoolean("enable_wine_debug", false) || preferences.getBoolean("enable_box64_logs", false);
+        boolean enableLogs = preferences.getBoolean("enable_wine_debug", false)
+                || preferences.getBoolean("enable_box64_logs", false)
+                || preferences.getBoolean("enable_fex_logs", false)
+                || preferences.getBoolean("enable_vulkan_api_dump", false)
+                || preferences.getBoolean("enable_turnip_logs", false);
         Menu menu = navigationView.getMenu();
         menu.findItem(R.id.main_menu_logs).setVisible(enableLogs);
         if (XrActivity.isEnabled(this)) menu.findItem(R.id.main_menu_magnifier).setVisible(false);
@@ -372,15 +368,21 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
             }
         });
 
-        imageFs = ImageFs.find(this);
-
-        String screenSize = Container.DEFAULT_SCREEN_SIZE;
-        containerManager = new ContainerManager(this);
-        container = containerManager.getContainerById(getIntent().getIntExtra("container_id", 0));
-
-        // Log shortcut_path
-        String shortcutPath = getIntent().getStringExtra("shortcut_path");
-        Log.d("XServerDisplayActivity", "Shortcut Path: " + shortcutPath);
+        imageFs = ImageFs.find(this);
+
+        String screenSize = Container.DEFAULT_SCREEN_SIZE;
+        containerManager = new ContainerManager(this);
+        ForensicLogger.logEvent(this, "info", "PARSER_MANAGER_INIT", forensicTraceId, "activity_init",
+                "ContainerManager initialized",
+                ForensicLogger.fields(
+                        "route", forensicRouteSource,
+                        "parser_summary", containerManager.getLastLoadReport().toSummaryString(),
+                        "containers_loaded", containerManager.getContainers().size()));
+        container = containerManager.getContainerById(getIntent().getIntExtra("container_id", 0));
+
+        // Log shortcut_path
+        String shortcutPath = getIntent().getStringExtra("shortcut_path");
+        Log.d("XServerDisplayActivity", "Shortcut Path: " + shortcutPath);
 
 
         // Determine container ID
@@ -393,15 +395,24 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
 
 
         // If container_id is 0, read from the .desktop file
-        if (containerId == 0 && shortcutPath != null && !shortcutPath.isEmpty()) {
-            File shortcutFile = new File(shortcutPath);
-            containerId = parseContainerIdFromDesktopFile(shortcutFile);
-            Log.d("XServerDisplayActivity", "Parsed Container ID from .desktop file: " + containerId);
-        }
-
-        // Initialize playtime tracking
-        playtimePrefs = getSharedPreferences("playtime_stats", MODE_PRIVATE);
-        shortcutName = getIntent().getStringExtra("shortcut_name");
+        if (containerId == 0 && shortcutPath != null && !shortcutPath.isEmpty()) {
+            File shortcutFile = new File(shortcutPath);
+            containerId = parseContainerIdFromDesktopFile(shortcutFile);
+            Log.d("XServerDisplayActivity", "Parsed Container ID from .desktop file: " + containerId);
+        }
+        forensicRouteSource = resolveForensicRouteSource(getIntent(), shortcutPath, containerId, forensicRouteSource);
+        ForensicLogger.logEvent(this, "info", "ROUTE_RESOLVED", forensicTraceId, "activity_init",
+                "Resolved launch route and container id",
+                ForensicLogger.fields(
+                        "route", forensicRouteSource,
+                        "container_id", containerId,
+                        "shortcut_path", shortcutPath,
+                        "forensic_mode", forensicMode,
+                        "forensic_skip_playtime", forensicSkipPlaytime));
+
+        // Initialize playtime tracking
+        playtimePrefs = getSharedPreferences("playtime_stats", MODE_PRIVATE);
+        shortcutName = getIntent().getStringExtra("shortcut_name");
 
         // Ensure shortcutPath is not null before proceeding
         if (shortcutPath != null && !shortcutPath.isEmpty()) {
@@ -416,25 +427,44 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
         // Increment play count at the start of a session
         incrementPlayCount();
 
-        // Log the final container_id
-        Log.d("XServerDisplayActivity", "Final Container ID: " + containerId);
-
-        // Retrieve the container and check if it's null
-        container = containerManager.getContainerById(containerId);
-
-        if (container == null) {
-            Log.e("XServerDisplayActivity", "Failed to retrieve container with ID: " + containerId);
-            finish();  // Gracefully exit the activity to avoid crashing
-            return;
-        }
-
-        containerManager.activateContainer(container);
-
-        if (shortcutPath != null && !shortcutPath.isEmpty()) {
-            shortcut = new Shortcut(container, new File(shortcutPath));
-        }
-
-        taskAffinityMask = (short) ProcessHelper.getAffinityMask(container.getCPUList(true));
+        // Log the final container_id
+        Log.d("XServerDisplayActivity", "Final Container ID: " + containerId);
+
+        // Retrieve the container and check if it's null
+        container = containerManager.getContainerById(containerId);
+
+        if (container == null) {
+            Log.e("XServerDisplayActivity", "Failed to retrieve container with ID: " + containerId);
+            ForensicLogger.warn(this, "ROUTE_CONTAINER_NOT_FOUND", forensicTraceId, "activity_init",
+                    "Container not found for resolved id",
+                    ForensicLogger.fields("route", forensicRouteSource, "container_id", containerId, "shortcut_path", shortcutPath));
+            finish();  // Gracefully exit the activity to avoid crashing
+            return;
+        }
+
+        if (shortcutPath != null && !shortcutPath.isEmpty()) {
+            shortcut = new Shortcut(container, new File(shortcutPath));
+        }
+
+        runtimeNormalization = ContainerNormalizer.normalizeForLaunch(container, shortcut);
+        if (runtimeNormalization.hasDrift()) {
+            ForensicLogger.logEvent(this, "warn", "RUNTIME_DRIFT_DETECTED", forensicTraceId, "activity_init",
+                    "Runtime configuration drift detected; applying in-memory normalization",
+                    ForensicLogger.fields(
+                            "route", forensicRouteSource,
+                            "container_id", container.id,
+                            "changed_fields", runtimeNormalization.changedFieldsJson()));
+            ForensicLogger.logEvent(this, "info", "RUNTIME_NORMALIZATION_APPLIED", forensicTraceId, "activity_init",
+                    "In-memory normalization prepared (no .container write)",
+                    runtimeNormalization.toJson());
+        }
+        ForensicLogger.logEvent(this, "info", "RUNTIME_SNAPSHOT_READY", forensicTraceId, "activity_init",
+                "Container forensic snapshot created",
+                ContainerForensicSnapshot.create(container, shortcut, runtimeNormalization, forensicRouteSource));
+
+        containerManager.activateContainer(container);
+
+        taskAffinityMask = (short) ProcessHelper.getAffinityMask(container.getCPUList(true));
         taskAffinityMaskWoW64 = (short) ProcessHelper.getAffinityMask(container.getCPUListWoW64(true));
 
         if (shortcut != null) {
@@ -446,33 +476,57 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
         String wmClass = shortcut != null ? shortcut.getExtra("wmClass", "") : "";
         Log.d("XServerDisplayActivity", "Startup wmClass: " + wmClass);
 
-        firstTimeBoot = container.getExtra("appVersion").isEmpty();
-
-        String wineVersion = container.getWineVersion();
-        wineInfo = WineInfo.fromIdentifier(this, contentsManager, wineVersion);
-
-        imageFs.setWinePath(wineInfo.path);
-
-        ProcessHelper.removeAllDebugCallbacks();
-        if (enableLogs) {
-            LogView.setFilename(getExecutable());
-            ProcessHelper.addDebugCallback(debugDialog = new DebugDialog(this));
-        }
-
-        graphicsDriver = container.getGraphicsDriver();
-        String graphicsDriverConfig = container.getGraphicsDriverConfig();
-        audioDriver = container.getAudioDriver();
-        emulator = container.getEmulator();
-        midiSoundFont = container.getMIDISoundFont();
-        dxwrapper = container.getDXWrapper();
-        String dxwrapperConfig = container.getDXWrapperConfig();
-        screenSize = container.getScreenSize();
-        winHandler.setInputType((byte) container.getInputType());
-        lc_all = container.getLC_ALL();
-
-        // Log the entire intent to verify the extras
-        Intent intent = getIntent();
-        Log.d("XServerDisplayActivity", "Intent Extras: " + intent.getExtras());
+        firstTimeBoot = container.getExtra("appVersion").isEmpty();
+
+        String wineVersion = runtimeNormalization != null ? runtimeNormalization.wineVersion : container.getWineVersion();
+        wineInfo = WineInfo.fromIdentifier(this, contentsManager, wineVersion);
+        ForensicLogger.logEvent(this, "info", "RUNTIME_WINEINFO_RESOLVED", forensicTraceId, "activity_init",
+                "Wine runtime resolved",
+                ForensicLogger.fields(
+                        "route", forensicRouteSource,
+                        "container_id", container.id,
+                        "wine_version", wineVersion,
+                        "wine_identifier", wineInfo != null ? wineInfo.identifier() : "",
+                        "wine_path", wineInfo != null ? wineInfo.path : ""));
+
+        imageFs.setWinePath(wineInfo.path);
+
+        ProcessHelper.removeAllDebugCallbacks();
+        if (enableLogs) {
+            LogView.setFilename(getExecutable());
+            ProcessHelper.addDebugCallback(debugDialog = new DebugDialog(this));
+        }
+        if (preferences.getBoolean("enable_fex_logs", false)) {
+            ProcessHelper.addDebugCallback(new FileDebugLogger(this, "fex"));
+        }
+        if (preferences.getBoolean("enable_vulkan_api_dump", false)) {
+            ProcessHelper.addDebugCallback(new FileDebugLogger(this, "vulkan"));
+        }
+        if (preferences.getBoolean("enable_turnip_logs", false)) {
+            ProcessHelper.addDebugCallback(new FileDebugLogger(this, "turnip"));
+        }
+
+        graphicsDriver = runtimeNormalization != null ? runtimeNormalization.graphicsDriver : container.getGraphicsDriver();
+        String graphicsDriverConfig = container.getGraphicsDriverConfig();
+        audioDriver = runtimeNormalization != null ? runtimeNormalization.audioDriver : container.getAudioDriver();
+        emulator = runtimeNormalization != null ? runtimeNormalization.emulator : container.getEmulator();
+        midiSoundFont = container.getMIDISoundFont();
+        dxwrapper = runtimeNormalization != null ? runtimeNormalization.dxwrapper : container.getDXWrapper();
+        String dxwrapperConfig = runtimeNormalization != null ? runtimeNormalization.dxwrapperConfig : container.getDXWrapperConfig();
+        screenSize = container.getScreenSize();
+        winHandler.setInputType((byte) container.getInputType());
+        lc_all = runtimeNormalization != null ? runtimeNormalization.lcAll : container.getLC_ALL();
+
+        // Log the entire intent to verify the extras
+        Intent intent = getIntent();
+        Log.d("XServerDisplayActivity", "Intent Extras: " + intent.getExtras());
+        ForensicLogger.logEvent(this, "info", "ROUTE_INTENT_EXTRAS", forensicTraceId, "activity_init",
+                "Intent extras captured",
+                ForensicLogger.fields(
+                        "route", forensicRouteSource,
+                        "container_id", container.id,
+                        "shortcut_path", shortcutPath,
+                        "shortcut_name", shortcutName));
 
         if (shortcut != null) {
             graphicsDriver = shortcut.getExtra("graphicsDriver", container.getGraphicsDriver());
@@ -742,14 +796,16 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
             sensorManager.registerListener(gyroListener, gyroSensor, SensorManager.SENSOR_DELAY_GAME);
         }
 
-        if (environment != null) {
-            xServerView.onResume();
-            environment.onResume();
-        }
-        startTime = System.currentTimeMillis();
-        handler.postDelayed(savePlaytimeRunnable, SAVE_INTERVAL_MS);
-        ProcessHelper.resumeAllWineProcesses();
-    }
+        if (environment != null) {
+            xServerView.onResume();
+            environment.onResume();
+        }
+        startTime = System.currentTimeMillis();
+        if (!forensicSkipPlaytime) {
+            handler.postDelayed(savePlaytimeRunnable, SAVE_INTERVAL_MS);
+        }
+        ProcessHelper.resumeAllWineProcesses();
+    }
 
     @Override
     public void onPause() {
@@ -776,9 +832,10 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
     }
 
 
-    private void savePlaytimeData() {
-        long endTime = System.currentTimeMillis();
-        long playtime = endTime - startTime;
+    private void savePlaytimeData() {
+        if (forensicSkipPlaytime || playtimePrefs == null) return;
+        long endTime = System.currentTimeMillis();
+        long playtime = endTime - startTime;
 
         // Ensure that playtime is not negative
         if (playtime < 0) {
@@ -798,12 +855,13 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
     }
 
 
-    private void incrementPlayCount() {
-        SharedPreferences.Editor editor = playtimePrefs.edit();
-        String playCountKey = shortcutName + "_play_count";
-        int playCount = playtimePrefs.getInt(playCountKey, 0) + 1;
-        editor.putInt(playCountKey, playCount);
-        editor.apply();
+    private void incrementPlayCount() {
+        if (forensicSkipPlaytime || playtimePrefs == null) return;
+        SharedPreferences.Editor editor = playtimePrefs.edit();
+        String playCountKey = shortcutName + "_play_count";
+        int playCount = playtimePrefs.getInt(playCountKey, 0) + 1;
+        editor.putInt(playCountKey, playCount);
+        editor.apply();
     }
 
     private void exit() {
@@ -1075,20 +1133,27 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
             if (Byte.parseByte(startupSelection) == Container.STARTUP_SELECTION_AGGRESSIVE) {
                 winHandler.killProcess("services.exe");
             }
-            guestProgramLauncherComponent.setContainer(this.container);
-            guestProgramLauncherComponent.setWineInfo(this.wineInfo);
-
-            String guestExecutable = "wine explorer /desktop=shell," + xServer.screenInfo + " " + getWineStartCommand();
-
-            guestProgramLauncherComponent.setGuestExecutable(guestExecutable);
-
-            envVars.putAll(container.getEnvVars());
-
-            if (shortcut != null) envVars.putAll(shortcut.getExtra("envVars"));
-
-            if (!envVars.has("WINEESYNC")) {
-                envVars.put("WINEESYNC", "1");
-            }
+            guestProgramLauncherComponent.setContainer(this.container);
+            guestProgramLauncherComponent.setWineInfo(this.wineInfo);
+            guestProgramLauncherComponent.setForensicMode(forensicMode);
+            guestProgramLauncherComponent.setForensicTraceId(forensicTraceId);
+            guestProgramLauncherComponent.setForensicRouteSource(forensicRouteSource);
+            if (runtimeNormalization != null) {
+                guestProgramLauncherComponent.setEmulatorOverride(runtimeNormalization.emulator);
+                guestProgramLauncherComponent.setBox64VersionOverride(runtimeNormalization.box64Version);
+                guestProgramLauncherComponent.setFexcoreVersionOverride(runtimeNormalization.fexcoreVersion);
+            }
+
+            String guestExecutable = "wine explorer /desktop=shell," + xServer.screenInfo + " " + getWineStartCommand();
+
+            guestProgramLauncherComponent.setGuestExecutable(guestExecutable);
+
+            if (runtimeNormalization != null) envVars.putAll(runtimeNormalization.envVars);
+            else envVars.putAll(container.getEnvVars());
+
+            if (!envVars.has("WINEESYNC")) {
+                envVars.put("WINEESYNC", "1");
+            }
 
             ArrayList<String> bindingPaths = new ArrayList<>();
             for (String[] drive : container.drivesIterator()) {
@@ -1097,18 +1162,22 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
 
             guestProgramLauncherComponent.setBindingPaths(bindingPaths.toArray(new String[0]));
 
-            guestProgramLauncherComponent.setBox64Preset(
-                    shortcut != null
-                            ? shortcut.getExtra("box64Preset", container.getBox64Preset())
-                            : container.getBox64Preset()
-            );
-
-            guestProgramLauncherComponent.setFEXCorePreset(
-                    shortcut != null
-                            ? shortcut.getExtra("fexcorePreset", container.getFEXCorePreset())
-                            : container.getFEXCorePreset()
-            );
-        }
+            guestProgramLauncherComponent.setBox64Preset(
+                    runtimeNormalization != null
+                            ? runtimeNormalization.box64Preset
+                            : shortcut != null
+                                    ? shortcut.getExtra("box64Preset", container.getBox64Preset())
+                                    : container.getBox64Preset()
+            );
+
+            guestProgramLauncherComponent.setFEXCorePreset(
+                    runtimeNormalization != null
+                            ? runtimeNormalization.fexcorePreset
+                            : shortcut != null
+                                    ? shortcut.getExtra("fexcorePreset", container.getFEXCorePreset())
+                                    : container.getFEXCorePreset()
+            );
+        }
 
         // Merge overrideEnvVars if present
         if (overrideEnvVars != null) {
@@ -1149,12 +1218,21 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
             );
         }
 
-        // Pass final envVars to the launcher
-        guestProgramLauncherComponent.setEnvVars(envVars);
-        guestProgramLauncherComponent.setTerminationCallback((status) -> exit());
-
-        // Add the launcher to our environment
-        environment.addComponent(guestProgramLauncherComponent);
+        // Pass final envVars to the launcher
+        guestProgramLauncherComponent.setEnvVars(envVars);
+        guestProgramLauncherComponent.setTerminationCallback((status) -> exit());
+        ForensicLogger.logEvent(this, "info", "LAUNCH_ENV_PREPARED", forensicTraceId, "setup_xenvironment",
+                "XEnvironment launch env prepared",
+                ForensicLogger.fields(
+                        "route", forensicRouteSource,
+                        "container_id", container != null ? container.id : 0,
+                        "env_hash", ForensicLogger.hashEnvVars(envVars),
+                        "wine_path", imageFs.getWinePath(),
+                        "dxwrapper", dxwrapper,
+                        "dxwrapper_config_hash", ForensicLogger.sha256Hex(String.valueOf(dxwrapperConfig))));
+
+        // Add the launcher to our environment
+        environment.addComponent(guestProgramLauncherComponent);
 
         // Start all environment components (XServer, Audio, etc.)
         environment.startEnvironmentComponents();
@@ -1470,12 +1548,44 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
         touchpadView.setSensitivity(profile.getCursorSpeed() * globalCursorSpeed);
         touchpadView.setPointerButtonRightEnabled(false);
 
-        inputControlsView.invalidate();
-    }
-
-    private void hideInputControls() {
-        inputControlsView.setShowTouchscreenControls(true);
-        inputControlsView.setVisibility(View.GONE);
+        inputControlsView.invalidate();
+    }
+
+    private void initForensicIntentState(Intent intent) {
+        if (intent == null) return;
+
+        forensicMode = intent.getBooleanExtra("forensic_mode", false);
+        forensicSkipPlaytime = intent.getBooleanExtra("forensic_skip_playtime", false);
+        forensicTraceId = intent.getStringExtra("forensic_trace_id");
+        if (forensicTraceId == null || forensicTraceId.trim().isEmpty()) {
+            if (forensicMode) forensicTraceId = ForensicLogger.newTraceId();
+        }
+        forensicRouteSource = intent.getStringExtra("forensic_route_source");
+        if (forensicRouteSource == null) forensicRouteSource = "";
+
+        ForensicLogger.logEvent(this, "info", "ROUTE_INTENT_RECEIVED", forensicTraceId, "activity_init",
+                "XServerDisplayActivity received intent",
+                ForensicLogger.fields(
+                        "forensic_mode", forensicMode,
+                        "forensic_skip_playtime", forensicSkipPlaytime,
+                        "forensic_route_source", forensicRouteSource,
+                        "container_id_extra", intent.getIntExtra("container_id", 0),
+                        "shortcut_path", intent.getStringExtra("shortcut_path")));
+    }
+
+    private static String resolveForensicRouteSource(Intent intent, String shortcutPath, int containerId, String currentRoute) {
+        if (currentRoute != null && !currentRoute.trim().isEmpty()) return currentRoute;
+        if (intent != null && intent.getBooleanExtra("forensic_mode", false) && containerId > 0) {
+            return "direct_diag_adb";
+        }
+        if (shortcutPath != null && !shortcutPath.isEmpty()) return "shortcut";
+        if (containerId > 0) return "main_activity";
+        return "unknown";
+    }
+
+    private void hideInputControls() {
+        inputControlsView.setShowTouchscreenControls(true);
+        inputControlsView.setVisibility(View.GONE);
         inputControlsView.setProfile(null);
 
         touchpadView.setSensitivity(globalCursorSpeed);
@@ -1509,10 +1619,23 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
             envVars.put("MESA_VK_WSI_DEBUG", "sw");
         }
 
-        envVars.put("VK_ICD_FILENAMES", imageFs.getShareDir() + "/vulkan/icd.d/wrapper_icd.aarch64.json");
-        envVars.put("GALLIUM_DRIVER", "zink");
-
-        if (firstTimeBoot) {
+        envVars.put("VK_ICD_FILENAMES", imageFs.getShareDir() + "/vulkan/icd.d/wrapper_icd.aarch64.json");
+        envVars.put("GALLIUM_DRIVER", "zink");
+        if (preferences.getBoolean("enable_vulkan_api_dump", false)) {
+            File apiDumpFile = WinlatorLogUtils.createTimestampedLogFile(this, "vulkan_api_dump");
+            String currentLayers = envVars.get("VK_INSTANCE_LAYERS");
+            String apiLayer = "VK_LAYER_LUNARG_api_dump";
+            if (currentLayers.isEmpty()) {
+                envVars.put("VK_INSTANCE_LAYERS", apiLayer);
+            } else if (!currentLayers.contains(apiLayer)) {
+                envVars.put("VK_INSTANCE_LAYERS", currentLayers + ":" + apiLayer);
+            }
+            envVars.put("VK_LUNARG_API_DUMP_FILE", "1");
+            envVars.put("VK_APIDUMP_LOG_FILENAME", apiDumpFile.getAbsolutePath());
+            envVars.put("VK_APIDUMP_FLUSH", "1");
+        }
+
+        if (firstTimeBoot) {
             Log.d("XServerDisplayActivity", "First time container boot, re-extracting libs");
             TarCompressorUtils.extract(TarCompressorUtils.Type.ZSTD, this, "graphics_driver/wrapper" + ".tzst", rootDir);
             TarCompressorUtils.extract(TarCompressorUtils.Type.ZSTD, this, "layers" + ".tzst", rootDir);
@@ -1521,10 +1644,17 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
                 TarCompressorUtils.extract(TarCompressorUtils.Type.ZSTD, this, "graphics_driver/zink_dlls" + ".tzst", new File(rootDir, imageFs.WINEPREFIX + "/drive_c/windows"));
         }
 
-        if (adrenoToolsDriverId != "System") {
-            AdrenotoolsManager adrenotoolsManager = new AdrenotoolsManager(this);
-            adrenotoolsManager.setDriverById(envVars, imageFs, adrenoToolsDriverId);
-        }
+        if (adrenoToolsDriverId != "System") {
+            AdrenotoolsManager adrenotoolsManager = new AdrenotoolsManager(this);
+            adrenotoolsManager.setDriverById(envVars, imageFs, adrenoToolsDriverId);
+        }
+        if (preferences.getBoolean("enable_turnip_logs", false)) {
+            File mesaLogFile = WinlatorLogUtils.createTimestampedLogFile(this, "turnip_mesa");
+            envVars.put("MESA_LOG_FILE", mesaLogFile.getAbsolutePath());
+            if (envVars.get("MESA_DEBUG").isEmpty()) {
+                envVars.put("MESA_DEBUG", "1");
+            }
+        }
 
         String vulkanVersion = graphicsDriverConfig.get("vulkanVersion");
         String vulkanVersionPatch = GPUInformation.getVulkanVersion(adrenoToolsDriverId, this).split("\\.")[2];
@@ -1590,7 +1720,7 @@ public class XServerDisplayActivity extends AppCompatActivity implements Navigat
             envVars.put("ENABLE_VKBASALT", "1");
             envVars.put("VKBASALT_CONFIG", vkbasaltConfig);
         }
-    }
+    }
 
     @Override
     public boolean dispatchGenericMotionEvent(MotionEvent event) {
diff --git a/app/src/main/java/com/winlator/cmod/contents/AdrenotoolsManager.java b/app/src/main/java/com/winlator/cmod/contents/AdrenotoolsManager.java
index 50b33d2..06396fe 100644
--- a/app/src/main/java/com/winlator/cmod/contents/AdrenotoolsManager.java
+++ b/app/src/main/java/com/winlator/cmod/contents/AdrenotoolsManager.java
@@ -162,44 +162,94 @@ public class AdrenotoolsManager {
     }
     
     public String installDriver(Uri driverUri) {
+        try (InputStream inputStream = mContext.getContentResolver().openInputStream(driverUri)) {
+            if (inputStream == null) {
+                Log.d("AdrenotoolsManager", "Failed to install driver, content resolver returned null stream");
+                return "";
+            }
+            return installDriverFromStream(inputStream);
+        } catch (IOException e) {
+            Log.d("AdrenotoolsManager", "Failed to install driver from uri", e);
+            return "";
+        }
+    }
+
+    public String installDriver(File driverFile) {
+        try (InputStream inputStream = Files.newInputStream(driverFile.toPath())) {
+            return installDriverFromStream(inputStream);
+        } catch (IOException e) {
+            Log.d("AdrenotoolsManager", "Failed to install driver from file", e);
+            return "";
+        }
+    }
+
+    private String installDriverFromStream(InputStream inputStream) {
         File tmpDir = new File(adrenotoolsContentDir, "tmp");
-        if (tmpDir.exists()) tmpDir.delete();
-        tmpDir.mkdirs();
-        ZipInputStream zis;
-        InputStream is;
+        if (tmpDir.exists()) FileUtils.delete(tmpDir);
+        if (!tmpDir.mkdirs()) {
+            Log.d("AdrenotoolsManager", "Failed to create temp directory for driver install");
+            return "";
+        }
+
         String name = "";
-        
-        try {
-            is = mContext.getContentResolver().openInputStream(driverUri);
-            zis = new ZipInputStream(is);
-            ZipEntry entry = zis.getNextEntry();
-            while (entry != null) {
-                File dstFile = new File(tmpDir, entry.getName());
-                Files.copy(zis, dstFile.toPath(), StandardCopyOption.REPLACE_EXISTING);
-                entry = zis.getNextEntry();
-            }
-            zis.close();
-            if (new File(tmpDir, "meta.json").exists()) {
-                name = getDriverName(tmpDir.getName());
-                File dst = new File(adrenotoolsContentDir, name);
-                if (!dst.exists() && !name.equals(""))
-                    tmpDir.renameTo(dst);
-                else {
-                    name = "";
+        try (ZipInputStream zis = new ZipInputStream(inputStream)) {
+            ZipEntry entry;
+            while ((entry = zis.getNextEntry()) != null) {
+                File dstFile = getSafeZipEntryFile(tmpDir, entry);
+                if (dstFile == null) {
+                    Log.d("AdrenotoolsManager", "Rejected zip entry outside target dir: " + entry.getName());
                     FileUtils.delete(tmpDir);
+                    return "";
                 }
+
+                if (entry.isDirectory()) {
+                    if (!dstFile.exists() && !dstFile.mkdirs()) {
+                        Log.d("AdrenotoolsManager", "Failed to create directory: " + dstFile.getAbsolutePath());
+                        FileUtils.delete(tmpDir);
+                        return "";
+                    }
+                    continue;
+                }
+
+                File parent = dstFile.getParentFile();
+                if (parent != null && !parent.exists() && !parent.mkdirs()) {
+                    Log.d("AdrenotoolsManager", "Failed to create parent dir: " + parent.getAbsolutePath());
+                    FileUtils.delete(tmpDir);
+                    return "";
+                }
+                Files.copy(zis, dstFile.toPath(), StandardCopyOption.REPLACE_EXISTING);
             }
-            else {
-                Log.d("AdrenotoolsManager", "Failed to install driver, a valid driver has not been selected");
-                tmpDir.delete();
+
+            File metaProfile = new File(tmpDir, "meta.json");
+            if (!metaProfile.exists()) {
+                Log.d("AdrenotoolsManager", "Failed to install driver, meta.json not found");
+                FileUtils.delete(tmpDir);
+                return "";
             }
+
+            name = getDriverName(tmpDir.getName());
+            File dst = new File(adrenotoolsContentDir, name);
+            if (name.isEmpty() || dst.exists() || !tmpDir.renameTo(dst)) {
+                Log.d("AdrenotoolsManager", "Failed to install driver, invalid name or target already exists: " + name);
+                FileUtils.delete(tmpDir);
+                return "";
+            }
+            return name;
+        } catch (IOException e) {
+            Log.d("AdrenotoolsManager", "Failed to install driver, invalid zip selected", e);
+            FileUtils.delete(tmpDir);
+            return "";
         }
-        catch (IOException e) {
-            Log.d("AdrenotoolsManager", "Failed to install driver, a valid driver has not been selected");
-            tmpDir.delete();
+    }
+
+    private File getSafeZipEntryFile(File rootDir, ZipEntry entry) throws IOException {
+        File target = new File(rootDir, entry.getName());
+        String rootPath = rootDir.getCanonicalPath() + File.separator;
+        String targetPath = target.getCanonicalPath();
+        if (!targetPath.startsWith(rootPath)) {
+            return null;
         }
-        
-        return name;
+        return target;
     }
     
     public void setDriverById(EnvVars envVars, ImageFs imagefs, String adrenotoolsDriverId) {
diff --git a/app/src/main/java/com/winlator/cmod/contents/ContentsManager.java b/app/src/main/java/com/winlator/cmod/contents/ContentsManager.java
index f939830..3e5d93b 100644
--- a/app/src/main/java/com/winlator/cmod/contents/ContentsManager.java
+++ b/app/src/main/java/com/winlator/cmod/contents/ContentsManager.java
@@ -24,7 +24,7 @@ import java.util.Map;
 
 public class ContentsManager {
     public static final String PROFILE_NAME = "profile.json";
-    public static final String REMOTE_PROFILES = "https://raw.githubusercontent.com/StevenMXZ/Winlator-Contents/main/contents.json";
+    public static final String REMOTE_PROFILES = "https://raw.githubusercontent.com/kosoymiki/winlator-wine-proton-arm64ec-wcp/main/contents/contents.json";
     public static final String[] DXVK_TRUST_FILES = {"${system32}/d3d8.dll", "${system32}/d3d9.dll", "${system32}/d3d10.dll", "${system32}/d3d10_1.dll",
             "${system32}/d3d10core.dll", "${system32}/d3d11.dll", "${system32}/dxgi.dll", "${syswow64}/d3d8.dll", "${syswow64}/d3d9.dll", "${syswow64}/d3d10.dll",
             "${syswow64}/d3d10_1.dll", "${syswow64}/d3d10core.dll", "${syswow64}/d3d11.dll", "${syswow64}/dxgi.dll"};
@@ -103,39 +103,33 @@ public class ContentsManager {
                 try {
                     JSONObject object = content.getJSONObject(i);
                     ContentProfile remoteProfile = new ContentProfile();
-                    remoteProfile.remoteUrl = object.optString("remoteUrl", "");
-                    remoteProfile.type = ContentProfile.ContentType.getTypeByName(object.optString("type", ""));
-                    remoteProfile.verName = object.optString("verName", "");
-                    remoteProfile.verCode = object.optInt("verCode", 0);
-                    if (remoteProfile.verCode == 0) {
-                        String verCodeText = object.optString("verCode", "0");
-                        try {
-                            remoteProfile.verCode = Integer.parseInt(verCodeText);
-                        } catch (NumberFormatException ignored) {
-                            remoteProfile.verCode = 0;
-                        }
-                    }
-
-                    if (remoteProfile.type == null || remoteProfile.remoteUrl.isEmpty() || remoteProfile.verName.isEmpty())
-                        continue;
+                    remoteProfile.remoteUrl = object.getString("remoteUrl");
+                    remoteProfile.type = ContentProfile.ContentType.getTypeByName(object.getString("type"));
+                    remoteProfile.verName = object.getString("verName");
+                    remoteProfile.verCode = object.getInt("verCode");
+                    remoteProfile.desc = object.optString("description", "");
+                    remoteProfile.displayCategory = object.optString(ContentProfile.MARK_DISPLAY_CATEGORY, "");
+                    remoteProfile.sourceRepo = object.optString(ContentProfile.MARK_SOURCE_REPO, "");
+                    remoteProfile.releaseTag = object.optString(ContentProfile.MARK_RELEASE_TAG, "");
+                    remoteProfile.delivery = object.optString(ContentProfile.MARK_DELIVERY, ContentProfile.DELIVERY_REMOTE);
 
-                    String verNameLower = remoteProfile.verName.toLowerCase(java.util.Locale.ROOT);
-                    String remoteUrlLower = remoteProfile.remoteUrl.toLowerCase(java.util.Locale.ROOT);
-                    boolean isBeta = object.optBoolean("beta", false)
-                            || verNameLower.contains("beta")
-                            || verNameLower.contains("nightly")
-                            || remoteUrlLower.contains("nightly");
-
-                    if (ignoreWine && remoteProfile.type == ContentProfile.ContentType.CONTENT_TYPE_WINE)
-                        continue;
+                    if (remoteProfile.type == null) continue;
+                    if (ignoreWine && remoteProfile.type == ContentProfile.ContentType.CONTENT_TYPE_WINE) continue;
                     if (remoteProfile.type == ContentProfile.ContentType.CONTENT_TYPE_BOX64
-                            || remoteProfile.type == ContentProfile.ContentType.CONTENT_TYPE_WOWBOX64)
-                        continue; // arm64ec-only, skip box64/wowbox64
-                    if (remoteProfile.type == ContentProfile.ContentType.CONTENT_TYPE_WINE
-                            && (verNameLower.contains("x86_64") || remoteUrlLower.contains("x86_64")))
-                        continue;
-                    if (!includeBeta && isBeta)
+                            || remoteProfile.type == ContentProfile.ContentType.CONTENT_TYPE_WOWBOX64) {
                         continue;
+                    }
+
+                    String verName = remoteProfile.verName != null ? remoteProfile.verName.toLowerCase() : "";
+                    String remoteUrl = remoteProfile.remoteUrl != null ? remoteProfile.remoteUrl.toLowerCase() : "";
+                    String channel = object.optString(ContentProfile.MARK_CHANNEL, "").trim().toLowerCase();
+                    if (channel.isEmpty()) {
+                        channel = deriveLegacyChannel(object, verName, remoteUrl);
+                    }
+                    remoteProfile.channel = channel;
+                    boolean isBeta = ContentProfile.CHANNEL_BETA.equals(channel)
+                            || ContentProfile.CHANNEL_NIGHTLY.equals(channel);
+                    if (!includeBeta && isBeta) continue;
 
                     remoteProfiles.add(remoteProfile);
                 } catch (JSONException e) {
@@ -273,10 +267,10 @@ public class ContentsManager {
         callback.onSucceed(profile);
     }
 
-    public ContentProfile readProfile(File file) {
-        try {
-            ContentProfile profile = new ContentProfile();
-            JSONObject profileJSONObject = new JSONObject(FileUtils.readString(file));
+    public ContentProfile readProfile(File file) {
+        try {
+            ContentProfile profile = new ContentProfile();
+            JSONObject profileJSONObject = new JSONObject(FileUtils.readString(file));
             String typeName = profileJSONObject.getString(ContentProfile.MARK_TYPE);
             String verName = profileJSONObject.getString(ContentProfile.MARK_VERSION_NAME);
             int verCode = profileJSONObject.getInt(ContentProfile.MARK_VERSION_CODE);
@@ -300,14 +294,26 @@ public class ContentsManager {
 
             profile.type = ContentProfile.ContentType.getTypeByName(typeName);
             profile.verName = verName;
-            profile.verCode = verCode;
-            profile.desc = desc;
-            profile.fileList = fileList;
-            return profile;
-        } catch (Exception e) {
-            return null;
-        }
-    }
+            profile.verCode = verCode;
+            profile.desc = desc;
+            profile.fileList = fileList;
+            profile.channel = profileJSONObject.optString(ContentProfile.MARK_CHANNEL, ContentProfile.CHANNEL_STABLE);
+            profile.delivery = profileJSONObject.optString(ContentProfile.MARK_DELIVERY, "");
+            profile.displayCategory = profileJSONObject.optString(ContentProfile.MARK_DISPLAY_CATEGORY, "");
+            profile.sourceRepo = profileJSONObject.optString(ContentProfile.MARK_SOURCE_REPO, "");
+            profile.releaseTag = profileJSONObject.optString(ContentProfile.MARK_RELEASE_TAG, "");
+            return profile;
+        } catch (Exception e) {
+            return null;
+        }
+    }
+
+    private String deriveLegacyChannel(JSONObject object, String verName, String remoteUrl) {
+        if (object.optBoolean("beta", false)) return ContentProfile.CHANNEL_BETA;
+        if (verName.contains("nightly") || remoteUrl.contains("nightly")) return ContentProfile.CHANNEL_NIGHTLY;
+        if (verName.contains("beta") || remoteUrl.contains("beta")) return ContentProfile.CHANNEL_BETA;
+        return ContentProfile.CHANNEL_STABLE;
+    }
 
     public List<ContentProfile> getProfiles(ContentProfile.ContentType type) {
         if (profilesMap != null)
diff --git a/app/src/main/java/com/winlator/cmod/core/FileDebugLogger.java b/app/src/main/java/com/winlator/cmod/core/FileDebugLogger.java
new file mode 100644
index 0000000..215ad43
--- /dev/null
+++ b/app/src/main/java/com/winlator/cmod/core/FileDebugLogger.java
@@ -0,0 +1,39 @@
+package com.winlator.cmod.core;
+
+import android.content.Context;
+import android.util.Log;
+
+import java.io.BufferedWriter;
+import java.io.Closeable;
+import java.io.File;
+import java.io.FileWriter;
+import java.io.IOException;
+
+public class FileDebugLogger implements Callback<String>, Closeable {
+    private final BufferedWriter writer;
+
+    public FileDebugLogger(Context context, String prefix) {
+        try {
+            File logFile = WinlatorLogUtils.createTimestampedLogFile(context, prefix);
+            writer = new BufferedWriter(new FileWriter(logFile));
+        } catch (IOException e) {
+            throw new RuntimeException("Unable to create runtime log file for " + prefix, e);
+        }
+    }
+
+    @Override
+    public synchronized void call(String line) {
+        try {
+            writer.write(line);
+            writer.newLine();
+            writer.flush();
+        } catch (IOException e) {
+            Log.e("FileDebugLogger", "Failed writing runtime log line", e);
+        }
+    }
+
+    @Override
+    public synchronized void close() throws IOException {
+        writer.close();
+    }
+}
diff --git a/app/src/main/java/com/winlator/cmod/core/ProcessHelper.java b/app/src/main/java/com/winlator/cmod/core/ProcessHelper.java
index 06c145c..88ee515 100644
--- a/app/src/main/java/com/winlator/cmod/core/ProcessHelper.java
+++ b/app/src/main/java/com/winlator/cmod/core/ProcessHelper.java
@@ -3,9 +3,10 @@ package com.winlator.cmod.core;
 import android.os.Process;
 import android.util.Log;
 
-import java.io.BufferedReader;
-import java.io.File;
-import java.io.FileInputStream;
+import java.io.BufferedReader;
+import java.io.Closeable;
+import java.io.File;
+import java.io.FileInputStream;
 import java.io.FilenameFilter;
 import java.io.IOException;
 import java.io.InputStream;
@@ -152,12 +153,22 @@ public abstract class ProcessHelper {
         });
     }
 
-    public static void removeAllDebugCallbacks() {
-        synchronized (debugCallbacks) {
-            debugCallbacks.clear();
-            Log.d("ProcessHelper", "All debug callbacks removed");
-        }
-    }
+    public static void removeAllDebugCallbacks() {
+        synchronized (debugCallbacks) {
+            for (Callback<String> callback : debugCallbacks) {
+                if (callback instanceof Closeable) {
+                    try {
+                        ((Closeable) callback).close();
+                    }
+                    catch (IOException e) {
+                        Log.e("ProcessHelper", "Failed closing debug callback", e);
+                    }
+                }
+            }
+            debugCallbacks.clear();
+            Log.d("ProcessHelper", "All debug callbacks removed");
+        }
+    }
 
     public static void addDebugCallback(Callback<String> callback) {
         synchronized (debugCallbacks) {
diff --git a/app/src/main/java/com/winlator/cmod/core/WinlatorLogUtils.java b/app/src/main/java/com/winlator/cmod/core/WinlatorLogUtils.java
new file mode 100644
index 0000000..12a1c60
--- /dev/null
+++ b/app/src/main/java/com/winlator/cmod/core/WinlatorLogUtils.java
@@ -0,0 +1,40 @@
+package com.winlator.cmod.core;
+
+import android.content.Context;
+import android.content.SharedPreferences;
+import android.net.Uri;
+import android.text.format.DateFormat;
+
+import androidx.preference.PreferenceManager;
+
+import com.winlator.cmod.SettingsFragment;
+
+import java.io.File;
+import java.util.Date;
+
+public abstract class WinlatorLogUtils {
+    public static File getLogsDir(Context context) {
+        SharedPreferences sp = PreferenceManager.getDefaultSharedPreferences(context);
+        String winlatorPath = sp.getString("winlator_path_uri", null);
+        File logsDir;
+
+        if (winlatorPath != null) {
+            Uri winlatorUri = Uri.parse(winlatorPath);
+            logsDir = new File(FileUtils.getFilePathFromUri(context, winlatorUri), "logs");
+        } else {
+            logsDir = new File(SettingsFragment.DEFAULT_WINLATOR_PATH, "logs");
+        }
+
+        if (!logsDir.exists()) {
+            logsDir.mkdirs();
+        }
+        return logsDir;
+    }
+
+    public static File createTimestampedLogFile(Context context, String prefix) {
+        String safePrefix = (prefix == null || prefix.trim().isEmpty()) ? "runtime" : prefix.trim();
+        safePrefix = safePrefix.replaceAll("[^a-zA-Z0-9._-]", "_").toLowerCase();
+        String fileName = safePrefix + "_" + DateFormat.format("yyyy-MM-dd_HH-mm-ss", new Date()) + ".txt";
+        return new File(getLogsDir(context), fileName);
+    }
+}
diff --git a/app/src/main/java/com/winlator/cmod/widget/LogView.java b/app/src/main/java/com/winlator/cmod/widget/LogView.java
index 9c0cb4d..1268117 100644
--- a/app/src/main/java/com/winlator/cmod/widget/LogView.java
+++ b/app/src/main/java/com/winlator/cmod/widget/LogView.java
@@ -16,11 +16,12 @@ import androidx.annotation.Nullable;
 import androidx.preference.PreferenceManager;
 
 import com.winlator.cmod.R;
-import com.winlator.cmod.SettingsFragment;
-import com.winlator.cmod.contentdialog.DebugDialog;
-import com.winlator.cmod.core.FileUtils;
-import com.winlator.cmod.core.UnitUtils;
-import com.winlator.cmod.math.Mathf;
+import com.winlator.cmod.SettingsFragment;
+import com.winlator.cmod.contentdialog.DebugDialog;
+import com.winlator.cmod.core.FileUtils;
+import com.winlator.cmod.core.UnitUtils;
+import com.winlator.cmod.core.WinlatorLogUtils;
+import com.winlator.cmod.math.Mathf;
 
 import java.io.File;
 import java.util.ArrayList;
@@ -189,25 +190,10 @@ public class LogView extends View {
         fileName = file.substring(0, file.lastIndexOf("."));
     }
 
-    public static File getLogFile(Context context) {
-        SharedPreferences sp = PreferenceManager.getDefaultSharedPreferences(context);
-        String winlatorPath = sp.getString("winlator_path_uri", null);
-        File logsDir;
-
-        if (winlatorPath != null) {
-            Uri winlatorUri = Uri.parse(winlatorPath);
-            logsDir = new File(FileUtils.getFilePathFromUri(context, winlatorUri), "logs");
-        }
-        else {
-            logsDir = new File(SettingsFragment.DEFAULT_WINLATOR_PATH, "logs");
-        }
-
-        if (!logsDir.exists())
-            logsDir.mkdirs();
-
-        String logFile = fileName.replaceAll("\\s", "_").toLowerCase() + "_" + DateFormat.format("yyyy-MM-dd_HH-mm-ss", new Date()) + ".txt";
-        return new File(logsDir, logFile);
-    }
+    public static File getLogFile(Context context) {
+        String logFile = fileName.replaceAll("\\s", "_").toLowerCase() + "_" + DateFormat.format("yyyy-MM-dd_HH-mm-ss", new Date()) + ".txt";
+        return new File(WinlatorLogUtils.getLogsDir(context), logFile);
+    }
     
     @Override
     public boolean onTouchEvent(MotionEvent event) {
diff --git a/app/src/main/java/com/winlator/cmod/xenvironment/components/GuestProgramLauncherComponent.java b/app/src/main/java/com/winlator/cmod/xenvironment/components/GuestProgramLauncherComponent.java
index 0f52873..c4dba41 100644
--- a/app/src/main/java/com/winlator/cmod/xenvironment/components/GuestProgramLauncherComponent.java
+++ b/app/src/main/java/com/winlator/cmod/xenvironment/components/GuestProgramLauncherComponent.java
@@ -14,15 +14,17 @@ import com.winlator.cmod.box64.Box64PresetManager;
 import com.winlator.cmod.container.Container;
 import com.winlator.cmod.container.Shortcut;
 import com.winlator.cmod.contents.ContentProfile;
-import com.winlator.cmod.contents.ContentsManager;
-import com.winlator.cmod.core.Callback;
-import com.winlator.cmod.core.EnvVars;
-import com.winlator.cmod.core.FileUtils;
-import com.winlator.cmod.core.GPUInformation;
-import com.winlator.cmod.core.KeyValueSet;
-import com.winlator.cmod.core.ProcessHelper;
-import com.winlator.cmod.core.TarCompressorUtils;
-import com.winlator.cmod.core.WineInfo;
+import com.winlator.cmod.contents.ContentsManager;
+import com.winlator.cmod.core.Callback;
+import com.winlator.cmod.core.EnvVars;
+import com.winlator.cmod.core.FileUtils;
+import com.winlator.cmod.core.ForensicLogger;
+import com.winlator.cmod.core.GPUInformation;
+import com.winlator.cmod.core.KeyValueSet;
+import com.winlator.cmod.core.ProcessHelper;
+import com.winlator.cmod.core.TarCompressorUtils;
+import com.winlator.cmod.core.WinlatorLogUtils;
+import com.winlator.cmod.core.WineInfo;
 import com.winlator.cmod.fexcore.FEXCoreManager;
 import com.winlator.cmod.fexcore.FEXCorePreset;
 import com.winlator.cmod.fexcore.FEXCorePresetManager;
@@ -54,9 +56,15 @@ public class GuestProgramLauncherComponent extends EnvironmentComponent {
     private Callback<Integer> terminationCallback;
     private static final Object lock = new Object();
     private final ContentsManager contentsManager;
-    private final ContentProfile wineProfile;
-    private Container container;
-    private final Shortcut shortcut;
+    private final ContentProfile wineProfile;
+    private Container container;
+    private final Shortcut shortcut;
+    private String forensicTraceId;
+    private String forensicRouteSource = "";
+    private boolean forensicMode;
+    private String emulatorOverride;
+    private String box64VersionOverride;
+    private String fexcoreVersionOverride;
 
     public void setWineInfo(WineInfo wineInfo) {
         this.wineInfo = wineInfo;
@@ -65,18 +73,26 @@ public class GuestProgramLauncherComponent extends EnvironmentComponent {
         return this.wineInfo;
     }
 
-    public Container getContainer() { return this.container; }
-    public void setContainer(Container container) { this.container = container; }
+    public Container getContainer() { return this.container; }
+    public void setContainer(Container container) { this.container = container; }
+    public void setForensicTraceId(String forensicTraceId) { this.forensicTraceId = forensicTraceId; }
+    public void setForensicRouteSource(String forensicRouteSource) { this.forensicRouteSource = forensicRouteSource != null ? forensicRouteSource : ""; }
+    public void setForensicMode(boolean forensicMode) { this.forensicMode = forensicMode; }
+    public void setEmulatorOverride(String emulatorOverride) { this.emulatorOverride = emulatorOverride; }
+    public void setBox64VersionOverride(String box64VersionOverride) { this.box64VersionOverride = box64VersionOverride; }
+    public void setFexcoreVersionOverride(String fexcoreVersionOverride) { this.fexcoreVersionOverride = fexcoreVersionOverride; }
 
     private void extractBox64Files() {
         ImageFs imageFs = environment.getImageFs();
         Context context = environment.getContext();
 
         // Fallback to default if the shared preference is not set or is empty
-        String box64Version = container.getBox64Version();
-
-        if (shortcut != null)
-            box64Version = shortcut.getExtra("box64Version", shortcut.container.getBox64Version());
+        String box64Version = !isEmpty(box64VersionOverride) ? box64VersionOverride : container.getBox64Version();
+
+        if (shortcut != null)
+            box64Version = shortcut.getExtra("box64Version", shortcut.container.getBox64Version());
+        if (!isEmpty(box64VersionOverride))
+            box64Version = box64VersionOverride;
 
         Log.d("GuestProgramLauncherComponent", "box64Version: " + box64Version);
 
@@ -105,12 +121,16 @@ public class GuestProgramLauncherComponent extends EnvironmentComponent {
         File system32dir = new File(rootDir + "/home/xuser/.wine/drive_c/windows/system32");
         boolean containerDataChanged = false;
 
-        String wowbox64Version = container.getBox64Version();
-        String fexcoreVersion = container.getFEXCoreVersion();
-
-        if (shortcut != null) {
-            wowbox64Version = shortcut.getExtra("box64Version", shortcut.container.getBox64Version());
-        }
+        String wowbox64Version = !isEmpty(box64VersionOverride) ? box64VersionOverride : container.getBox64Version();
+        String fexcoreVersion = !isEmpty(fexcoreVersionOverride) ? fexcoreVersionOverride : container.getFEXCoreVersion();
+
+        if (shortcut != null) {
+            wowbox64Version = shortcut.getExtra("box64Version", shortcut.container.getBox64Version());
+        }
+        if (!isEmpty(box64VersionOverride))
+            wowbox64Version = box64VersionOverride;
+        if (!isEmpty(fexcoreVersionOverride))
+            fexcoreVersion = fexcoreVersionOverride;
 
         Log.d("GuestProgramLauncherComponent", "box64Version in use: " + wowbox64Version);
         Log.d("GuestProgramLauncherComponent", "fexcoreVersion in use: " + fexcoreVersion);
@@ -242,10 +262,11 @@ public class GuestProgramLauncherComponent extends EnvironmentComponent {
         ImageFs imageFs = environment.getImageFs();
         File rootDir = imageFs.getRootDir();
 
-        SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(context);
-        boolean enableBox64Logs = preferences.getBoolean("enable_box64_logs", false);
-        boolean openWithAndroidBrowser = preferences.getBoolean("open_with_android_browser", false);
-        boolean shareAndroidClipboard = preferences.getBoolean("share_android_clipboard", false);
+        SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(context);
+        boolean enableBox64Logs = preferences.getBoolean("enable_box64_logs", false);
+        boolean enableFexLogs = preferences.getBoolean("enable_fex_logs", false);
+        boolean openWithAndroidBrowser = preferences.getBoolean("open_with_android_browser", false);
+        boolean shareAndroidClipboard = preferences.getBoolean("share_android_clipboard", false);
 
         if (openWithAndroidBrowser)
             envVars.put("WINE_OPEN_WITH_ANDROID_BROWSER", "1");
@@ -349,11 +370,19 @@ public class GuestProgramLauncherComponent extends EnvironmentComponent {
             envVars.putAll(this.envVars);
         }
 
-        String emulator = container.getEmulator();
-        if (shortcut != null)
-            emulator = shortcut.getExtra("emulator", container.getEmulator());
-
-        // Construct the command without Box64 to the Wine executable
+        String emulator = !isEmpty(emulatorOverride) ? emulatorOverride : container.getEmulator();
+        if (shortcut != null)
+            emulator = shortcut.getExtra("emulator", container.getEmulator());
+        if (!isEmpty(emulatorOverride))
+            emulator = emulatorOverride;
+
+        if (enableFexLogs && emulator != null && emulator.equalsIgnoreCase("fexcore")) {
+            File fexLogFile = WinlatorLogUtils.createTimestampedLogFile(context, "fex_runtime");
+            envVars.put("FEX_LOG_LEVEL", "debug");
+            envVars.put("FEX_LOG_FILE", fexLogFile.getAbsolutePath());
+        }
+
+        // Construct the command without Box64 to the Wine executable
         String command = "";
         String overriddenCommand = envVars.get("GUEST_PROGRAM_LAUNCHER_COMMAND");
         if (!overriddenCommand.isEmpty()) {
@@ -376,19 +405,44 @@ public class GuestProgramLauncherComponent extends EnvironmentComponent {
 
         // **Maybe remove this: Set execute permissions for box64 if necessary (Glibc/Proot artifact)
         File box64File = new File(rootDir, "/usr/bin/box64");
-        if (box64File.exists()) {
-            FileUtils.chmod(box64File, 0755);
-        }
-
-        return ProcessHelper.exec(command, envVars.toStringArray(), rootDir, (status) -> {
-            synchronized (lock) {
-                pid = -1;
-            }
-
-            if (terminationCallback != null)
-                terminationCallback.call(status);
-        });
-    }
+        if (box64File.exists()) {
+            FileUtils.chmod(box64File, 0755);
+        }
+
+        if (forensicMode || !isEmpty(forensicTraceId)) {
+            ForensicLogger.logEvent(context, "info", "LAUNCH_EXEC_SUBMIT", forensicTraceId, "launcher",
+                    "Submitting guest process execution",
+                    ForensicLogger.fields(
+                            "container_id", container != null ? container.id : 0,
+                            "route", forensicRouteSource,
+                            "wine_version", container != null ? container.getWineVersion() : "",
+                            "wine_path", imageFs.getWinePath(),
+                            "emulator", emulator,
+                            "box64_preset", box64Preset,
+                            "fexcore_preset", fexcorePreset,
+                            "box64_version", !isEmpty(box64VersionOverride) ? box64VersionOverride : container != null ? container.getBox64Version() : "",
+                            "fexcore_version", !isEmpty(fexcoreVersionOverride) ? fexcoreVersionOverride : container != null ? container.getFEXCoreVersion() : "",
+                            "command", command,
+                            "env_hash", ForensicLogger.hashEnvVars(envVars)));
+        }
+
+        return ProcessHelper.exec(command, envVars.toStringArray(), rootDir, (status) -> {
+            synchronized (lock) {
+                pid = -1;
+            }
+
+            if (forensicMode || !isEmpty(forensicTraceId)) {
+                ForensicLogger.logEvent(context, "info", "LAUNCH_EXEC_EXIT", forensicTraceId, "launcher",
+                        "Guest process exited",
+                        ForensicLogger.fields(
+                                "container_id", container != null ? container.id : 0,
+                                "route", forensicRouteSource,
+                                "exit_status", status));
+            }
+            if (terminationCallback != null)
+                terminationCallback.call(status);
+        });
+    }
 
     private void addBox64EnvVars(EnvVars envVars, boolean enableLogs) {
         envVars.put("BOX64_NOBANNER", ProcessHelper.PRINT_DEBUG && enableLogs ? "0" : "1");
@@ -410,9 +464,13 @@ public class GuestProgramLauncherComponent extends EnvironmentComponent {
         }
     }
 
-    public void resumeProcess() {
-        synchronized (lock) {
-            if (pid != -1) ProcessHelper.resumeProcess(pid);
-        }
-    }
+    public void resumeProcess() {
+        synchronized (lock) {
+            if (pid != -1) ProcessHelper.resumeProcess(pid);
+        }
+    }
+
+    private static boolean isEmpty(String value) {
+        return value == null || value.trim().isEmpty();
+    }
 }
diff --git a/app/src/main/res/layout/adrenotools_fragment.xml b/app/src/main/res/layout/adrenotools_fragment.xml
index 2154e46..11e5eff 100644
--- a/app/src/main/res/layout/adrenotools_fragment.xml
+++ b/app/src/main/res/layout/adrenotools_fragment.xml
@@ -1,7 +1,9 @@
 <?xml version="1.0" encoding="utf-8"?>
-<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
-    android:layout_width="match_parent"
-    android:layout_height="match_parent"
+
+
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
     android:orientation="vertical"
     android:padding="16dp">
 
@@ -19,21 +21,22 @@
     <LinearLayout
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
-        android:orientation="vertical">
+        android:orientation="horizontal">
 
-        <Button
-            android:id="@+id/BTInstallDriver"
-            style="@style/ButtonNeutral"
-            android:layout_width="match_parent"
+        <Button
+            android:id="@+id/BTInstallDriver"
+            style="@style/ButtonNeutral"
+            android:layout_width="0dp"
             android:layout_height="wrap_content"
+            android:layout_weight="1"
             android:text="@string/install_drivers" />
 
         <Button
             android:id="@+id/BTFetchLatestDriver"
             style="@style/ButtonPositive"
-            android:layout_width="match_parent"
+            android:layout_width="0dp"
             android:layout_height="wrap_content"
-            android:layout_marginTop="8dp"
+            android:layout_weight="1"
             android:text="@string/fetch_latest_turnip" />
 
     </LinearLayout>
diff --git a/app/src/main/res/layout/contents_fragment.xml b/app/src/main/res/layout/contents_fragment.xml
index 4b41314..829b778 100644
--- a/app/src/main/res/layout/contents_fragment.xml
+++ b/app/src/main/res/layout/contents_fragment.xml
@@ -6,23 +6,23 @@
     android:orientation="vertical"
     android:padding="16dp">
 
-    <TextView
-        style="@style/TextViewEmphasis"
-        android:layout_width="wrap_content"
-        android:layout_height="wrap_content"
-        android:text="@string/content_type" />
-
+    <TextView
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="@string/content_type" />
+
     <LinearLayout
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
         android:gravity="center_vertical"
         android:orientation="horizontal">
-
-        <Spinner
-            android:id="@+id/SContentType"
-            style="@style/ComboBox"
-            android:layout_width="match_parent"
-            android:layout_height="wrap_content" />
+
+        <Spinner
+            android:id="@+id/SContentType"
+            style="@style/ComboBox"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_weight="1" />
 
     </LinearLayout>
 
@@ -36,10 +36,10 @@
 
         <Switch
             android:id="@+id/SwShowBeta"
-            android:layout_width="match_parent"
+            style="@style/SwitchCompat"
+            android:layout_width="wrap_content"
             android:layout_height="wrap_content"
-            android:text="@string/show_beta_releases"
-            android:textColor="?android:textColorPrimary" />
+            android:text="@string/show_beta_releases" />
     </LinearLayout>
 
     <View style="@style/HorizontalLine" />
@@ -69,12 +69,13 @@
         android:layout_height="wrap_content"
         android:orientation="horizontal">
 
-        <Button
-            android:id="@+id/BTInstallContent"
-            style="@style/ButtonNeutral"
-            android:layout_width="match_parent"
-            android:layout_height="wrap_content"
-            android:text="@string/install_content" />
-
+        <Button
+            android:id="@+id/BTInstallContent"
+            style="@style/ButtonNeutral"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_weight="1"
+            android:text="@string/install_content" />
+
     </LinearLayout>
 </LinearLayout>
diff --git a/app/src/main/res/layout/settings_fragment.xml b/app/src/main/res/layout/settings_fragment.xml
index 35e5417..597d9e5 100644
--- a/app/src/main/res/layout/settings_fragment.xml
+++ b/app/src/main/res/layout/settings_fragment.xml
@@ -455,13 +455,34 @@
 
                     <View style="@style/FieldSeparator" />
 
-                    <CheckBox
-                        android:id="@+id/CBEnableBox64Logs"
-                        android:layout_width="wrap_content"
-                        android:layout_height="wrap_content"
-                        android:text="@string/enable_box64_logs"
-                        android:layout_marginTop="8dp" />
-                </LinearLayout>
+                    <CheckBox
+                        android:id="@+id/CBEnableBox64Logs"
+                        android:layout_width="wrap_content"
+                        android:layout_height="wrap_content"
+                        android:text="@string/enable_box64_logs"
+                        android:layout_marginTop="8dp" />
+
+                    <CheckBox
+                        android:id="@+id/CBEnableFEXLogs"
+                        android:layout_width="wrap_content"
+                        android:layout_height="wrap_content"
+                        android:text="@string/enable_fex_logs"
+                        android:layout_marginTop="8dp" />
+
+                    <CheckBox
+                        android:id="@+id/CBEnableVulkanLogs"
+                        android:layout_width="wrap_content"
+                        android:layout_height="wrap_content"
+                        android:text="@string/enable_vulkan_api_dump"
+                        android:layout_marginTop="8dp" />
+
+                    <CheckBox
+                        android:id="@+id/CBEnableTurnipLogs"
+                        android:layout_width="wrap_content"
+                        android:layout_height="wrap_content"
+                        android:text="@string/enable_turnip_logs"
+                        android:layout_marginTop="8dp" />
+                </LinearLayout>
 
                 <TextView
                     android:id="@+id/TVLogs"
diff --git a/app/src/main/res/values/colors.xml b/app/src/main/res/values/colors.xml
index 54e5949..78b03f1 100644
--- a/app/src/main/res/values/colors.xml
+++ b/app/src/main/res/values/colors.xml
@@ -1,24 +1,24 @@
 <?xml version="1.0" encoding="utf-8"?>
 <resources>
     <!-- Light Theme Colors -->
-    <color name="window_background_color">#f4faf7</color>
-    <color name="colorPrimary">#0e5f4a</color>
-    <color name="colorPrimaryDark">#084c3a</color>
-    <color name="colorAccent">#0b8f6a</color>
+    <color name="window_background_color">#f4faf7</color>
+    <color name="colorPrimary">#0e5f4a</color>
+    <color name="colorPrimaryDark">#084c3a</color>
+    <color name="colorAccent">#0b8f6a</color>
     <color name="black">#000000</color>
 
     <!-- Dark Theme Colors -->
-    <color name="window_background_color_dark">#0d1311</color>
-    <color name="colorPrimaryDarkMode">#12372d</color>
-    <color name="colorPrimaryDarkModeDark">#0a251e</color>
-    <color name="colorAccentDark">#41d39c</color>
+    <color name="window_background_color_dark">#0d1311</color>
+    <color name="colorPrimaryDarkMode">#12372d</color>
+    <color name="colorPrimaryDarkModeDark">#0a251e</color>
+    <color name="colorAccentDark">#41d39c</color>
     <color name="white">#ffffff</color>
 
     <!-- Additional Colors for Dark Mode -->
     <color name="combo_box_dark">#303030</color>
     <color name="content_dialog_background_dark">#424242</color>
     <color name="button_neutral_dark">#37474f</color>
-    <color name="button_positive_dark">#1e88e5</color>
+    <color name="button_positive_dark">#0fa77a</color>
 
     <color name="abc_decor_view_status_guard">#ff000000</color>
     <color name="abc_decor_view_status_guard_light">#ffffffff</color>
@@ -94,8 +94,8 @@
     <color name="material_blue_grey_800">#ff37474f</color>
     <color name="material_blue_grey_900">#ff263238</color>
     <color name="material_blue_grey_950">#ff21272b</color>
-    <color name="material_deep_teal_200">#ff80cbc4</color>
-    <color name="material_deep_teal_500">#ff008577</color>
+    <color name="material_deep_teal_200">#ff41d39c</color>
+    <color name="material_deep_teal_500">#ff0b8f6a</color>
     <color name="material_grey_100">#fff5f5f5</color>
     <color name="material_grey_300">#ffe0e0e0</color>
     <color name="material_grey_50">#fffafafa</color>
@@ -113,7 +113,7 @@
     <color name="mtrl_textinput_hovered_box_stroke_color">#de000000</color>
     <color name="notification_action_color_filter">@color/androidx_core_secondary_text_default_material_light</color>
     <color name="notification_icon_bg_color">#ff9e9e9e</color>
-    <color name="preference_fallback_accent_color">#ff008577</color>
+    <color name="preference_fallback_accent_color">#ff0b8f6a</color>
     <color name="primary_dark_material_dark">@android:color/black</color>
     <color name="primary_dark_material_light">@color/material_grey_600</color>
     <color name="primary_material_dark">@color/material_grey_900</color>
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
index 80bd2a9..cc5d1a4 100644
--- a/app/src/main/res/values/strings.xml
+++ b/app/src/main/res/values/strings.xml
@@ -4,7 +4,7 @@
     <!ENTITY TERMUX_X11_APP_NAME "Winlator:X11">
     ]>
 <resources>
-    <string name="app_name">by.aero.so (benchmark)</string>
+    <string name="app_name">Winlator CMOD Aero.so</string>
     <string name="run">Run</string>
     <string name="edit">Edit</string>
     <string name="remove">Remove</string>
@@ -312,9 +312,10 @@
     <string name="do_you_want_to_restore_default_profile">Do you want to restore default profile?</string>
     <string name="simulate_touch_screen">Simulate touch screen</string>
     <string name="install_content">Install Content</string>
-    <string name="content_type">Content Type</string>
-    <string name="contents">Contents</string>
-    <string name="do_you_want_to_install_content">Do you want to install additional content?</string>
+    <string name="content_type">Content Type</string>
+    <string name="contents">Contents</string>
+    <string name="wine_proton">Wine/Proton</string>
+    <string name="do_you_want_to_install_content">Do you want to install additional content?</string>
     <string name="pls_make_sure_content_trustworthy">Contents contain executable files. Unsafe executable files may compromise your data or device security. Before installing, PLEASE make sure that the additional content you are installing is trustworthy.</string>
     <string name="content_suffix_is_wcp_packed_xz_zst">The content files have the .wcp extension and are compressed using either xz or zst formats.</string>
     <string name="installing_content">Installing Content…</string>
@@ -343,7 +344,7 @@
     <string name="reinstall_imagefs">Reinstall Imagefs</string>
     <string name="do_you_want_to_reinstall_imagefs">Do you want to reinstall imagefs? This operation will restore system files, your containers won\'t be changed.</string>
     <string name="unable_to_remove_content_since_container_using">Unable to remove this content, because a container is currently using this Wine.</string>
-    <string name="get_more_contents_form_github">You can access https://github.com/longjunyu2/winlator/releases to get more contents.</string>
+    <string name="get_more_contents_form_github">You can access our repository releases for Winlator CMOD Aero.so content packages (Wine/Proton and tools).</string>
     <string name="setup_failed">Setup failed</string>
     <string name="graphics_driver_configuration">Graphics Driver Configuration</string>
     <string name="select_graphics_driver_version">Select Graphics Driver Version:</string>
@@ -615,10 +616,27 @@ E.g. <b>META</b> for <i>META key</i>, \n
     <string name="install_drivers">Install Drivers</string>
     <string name="install_drivers_message">You will now be prompted to pick a driver. These must be the same ones used in other emulators like Yuzu, Dolphin, Citra, etc.</string>
     <string name="install_drivers_warning">Be warned that because of limitations of current PC emulators, Qualcomm Drivers may not work on chipsets below 8 Gen2 without getting patched.</string>
-    <string name="fetch_latest_turnip">Download Turnip driver</string>
-    <string name="turnip_loading_releases">Loading Turnip releases...</string>
-    <string name="show_beta_releases">Show beta / nightly packages</string>
+    <string name="fetch_latest_turnip">Browse Turnip versions (latest + history)</string>
+    <string name="turnip_choose_version">Choose Turnip version</string>
+    <string name="turnip_channel_latest">Latest</string>
+    <string name="loading_turnip_versions">Loading Turnip versions…</string>
+    <string name="unable_to_fetch_turnip_versions">Unable to fetch Turnip versions.</string>
+    <string name="turnip_download_failed">Turnip download failed.</string>
+    <string name="turnip_install_failed_or_exists">Turnip install failed or version is already installed.</string>
+    <string name="show_beta_releases">Show beta / nightly builds</string>
+    <string name="channel_stable">Stable</string>
+    <string name="channel_beta">Beta</string>
+    <string name="channel_nightly">Nightly</string>
+    <string name="package_source_online">Online package</string>
+    <string name="package_source_installed">Installed locally</string>
+    <string name="package_source_embedded">Embedded package</string>
+    <string name="package_source_online_not_embedded">Downloaded on demand (not embedded in APK)</string>
+    <string name="package_source_repo_prefix">Source</string>
+    <string name="package_source_github_release">GitHub Release</string>
+    <string name="refresh">Refresh</string>
+    <string name="enable_fex_logs">Enable FEX logs</string>
     <string name="enable_vulkan_api_dump">Enable dumping of Vulkan api calls to file.</string>
+    <string name="enable_turnip_logs">Enable Turnip/Mesa logs</string>
     <string name="dll_emulator">32bit Emulator</string>
     <string name="open_with_android_browser">Open Android Browser in Wine</string>
     <string name="share_android_clipboard">Share Android Clipboard with Wine</string>
@@ -635,7 +653,19 @@ E.g. <b>META</b> for <i>META key</i>, \n
     <string name="graphics_driver_bcn_emulation_cache">BCn Emulation Cache</string>
     <string name="vkbasalt">vkBasalt</string>
     <string name="vkbasalt_sharpness_effects">Sharpness Effect</string>
-    <string name="vkbasalt_sharpness_level">Sharpness Level</string>
-    <string name="vkbasalt_sharpness_denoise">Sharpeness Denoise</string>
-    <string name="shutdown">Shutdown</string>
+    <string name="vkbasalt_sharpness_level">Sharpness Level</string>
+    <string name="vkbasalt_sharpness_denoise">Sharpeness Denoise</string>
+    <string name="diagnostics">Diagnostics</string>
+    <string name="diagnostics_hint">Use this screen to validate the container parser and launch XServer directly with forensic tracing.</string>
+    <string name="diagnostics_container_id_hint">Container ID (e.g. 1)</string>
+    <string name="diagnostics_run_direct_xserver">Run Direct XServer (forensic)</string>
+    <string name="diagnostics_validate_parser">Validate Containers Parser</string>
+    <string name="diagnostics_show_last_trace">Show Last Forensic Trace</string>
+    <string name="diagnostics_waiting">Waiting for a diagnostics action...</string>
+    <string name="diagnostics_parser_summary">Parser summary</string>
+    <string name="diagnostics_parser_warnings">Warnings</string>
+    <string name="diagnostics_invalid_container_id">Enter a valid container ID.</string>
+    <string name="diagnostics_trace_summary_loaded">Loaded latest forensic trace summary.</string>
+    <string name="diagnostics_direct_launch_started">Started direct forensic launch for container %1$d (trace %2$s)</string>
+    <string name="shutdown">Shutdown</string>
 </resources>
diff --git a/app/src/main/res/values/styles.xml b/app/src/main/res/values/styles.xml
index 8afadc1..8dd2d86 100644
--- a/app/src/main/res/values/styles.xml
+++ b/app/src/main/res/values/styles.xml
@@ -1,15 +1,13 @@
 <?xml version="1.0" encoding="utf-8"?>
 <resources>
     <!-- Light Theme -->
-    <style name="AppTheme" parent="@style/Theme.AppCompat.Light.NoActionBar">
-        <item name="colorAccent">@color/colorAccent</item>
-        <item name="colorPrimary">@color/colorPrimary</item>
-        <item name="colorPrimaryDark">@color/colorPrimaryDark</item>
-        <item name="android:fontFamily">sans-serif</item>
-        <item name="fontFamily">sans-serif</item>
-        <item name="android:windowBackground">@color/window_background_color</item>
-        <item name="android:colorBackground">@color/window_background_color</item>
-        <item name="android:textViewStyle">@style/TextView</item>
+    <style name="AppTheme" parent="@style/Theme.AppCompat.Light.NoActionBar">
+        <item name="colorAccent">@color/colorAccent</item>
+        <item name="colorPrimary">@color/colorPrimary</item>
+        <item name="colorPrimaryDark">@color/colorPrimaryDark</item>
+        <item name="android:windowBackground">@color/window_background_color</item>
+        <item name="android:colorBackground">@color/window_background_color</item>
+        <item name="android:textViewStyle">@style/TextView</item>
         <item name="android:checkboxStyle">@style/CheckBox</item>
         <item name="android:listPopupWindowStyle">@style/ListPopupWindow</item>
         <item name="listPopupWindowStyle">@style/ListPopupWindow</item>
@@ -20,15 +18,13 @@
     </style>
 
     <!-- Dark Theme -->
-    <style name="AppTheme.Dark" parent="@style/Theme.AppCompat.NoActionBar">
-        <item name="colorAccent">@color/colorAccentDark</item>
-        <item name="colorPrimary">@color/colorPrimaryDarkMode</item>
-        <item name="colorPrimaryDark">@color/colorPrimaryDarkModeDark</item>
-        <item name="android:fontFamily">sans-serif</item>
-        <item name="fontFamily">sans-serif</item>
-        <item name="android:windowBackground">@color/window_background_color_dark</item>
-        <item name="android:colorBackground">@color/window_background_color_dark</item>
-        <item name="android:textViewStyle">@style/TextView.Dark</item>
+    <style name="AppTheme.Dark" parent="@style/Theme.AppCompat.NoActionBar">
+        <item name="colorAccent">@color/colorAccentDark</item>
+        <item name="colorPrimary">@color/colorPrimaryDarkMode</item>
+        <item name="colorPrimaryDark">@color/colorPrimaryDarkModeDark</item>
+        <item name="android:windowBackground">@color/window_background_color_dark</item>
+        <item name="android:colorBackground">@color/window_background_color_dark</item>
+        <item name="android:textViewStyle">@style/TextView.Dark</item>
         <item name="android:checkboxStyle">@style/CheckBox.Dark</item>
         <item name="android:listPopupWindowStyle">@style/ListPopupWindow.Dark</item>
         <item name="listPopupWindowStyle">@style/ListPopupWindow.Dark</item>
@@ -143,19 +139,14 @@
         <item name="android:background">@drawable/edit_text_dark</item>
     </style>
 
-    <!-- TextView Styles -->
-    <style name="TextView" parent="@android:style/Widget.TextView">
-        <item name="android:textSize">16sp</item>
-        <item name="android:fontFamily">sans-serif</item>
-    </style>
-
-    <style name="TextViewEmphasis" parent="TextView">
-        <item name="android:textStyle">italic</item>
-    </style>
-
-    <style name="TextView.Dark" parent="TextView">
-        <item name="android:textColor">#ffffff</item>
-    </style>
+    <!-- TextView Styles -->
+    <style name="TextView" parent="@android:style/Widget.TextView">
+        <item name="android:textSize">16sp</item>
+    </style>
+
+    <style name="TextView.Dark" parent="TextView">
+        <item name="android:textColor">#ffffff</item>
+    </style>
 
     <!-- CheckBox Styles -->
     <style name="CheckBox" parent="@android:style/Widget.CompoundButton.CheckBox">
@@ -165,15 +156,18 @@
         <item name="android:textSize">16sp</item>
     </style>
 
-    <style name="CheckBox.Dark" parent="CheckBox">
-        <item name="colorAccent">@color/colorAccentDark</item>
-        <item name="android:textColorSecondary">@color/colorPrimaryDark</item>
-        <item name="android:textColor">#ffffff</item>
-        <item name="android:textSize">16sp</item>
-    </style>
-
-    <!-- Button Styles -->
-    <style name="BaseButton">
+    <style name="CheckBox.Dark" parent="CheckBox">
+        <item name="colorAccent">@color/colorAccentDark</item>
+        <item name="android:textColorSecondary">@color/colorPrimaryDark</item>
+        <item name="android:textColor">#ffffff</item>
+        <item name="android:textSize">16sp</item>
+    </style>
+
+    <!-- Compatibility alias used by patched layouts -->
+    <style name="SwitchCompat" parent="Widget.AppCompat.CompoundButton.Switch" />
+
+    <!-- Button Styles -->
+    <style name="BaseButton">
         <item name="android:layout_width">wrap_content</item>
         <item name="android:layout_height">42dp</item>
         <item name="android:focusable">true</item>
@@ -181,12 +175,10 @@
         <item name="android:textSize">16sp</item>
         <item name="android:lines">1</item>
         <item name="android:gravity">center</item>
-        <item name="android:paddingLeft">24dp</item>
-        <item name="android:paddingRight">24dp</item>
-        <item name="android:textAllCaps">false</item>
-        <item name="android:fontFamily">sans-serif</item>
-        <item name="android:textStyle">italic</item>
-    </style>
+        <item name="android:paddingLeft">24dp</item>
+        <item name="android:paddingRight">24dp</item>
+        <item name="android:textAllCaps">false</item>
+    </style>
 
     <style name="BaseButton.Dark" parent="BaseButton">
         <item name="android:textColor">#ffffff</item>
-- 
2.43.0
